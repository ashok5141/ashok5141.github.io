
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ashok5141.github.io/appsec/WAHH/">
      
      
        <link rel="prev" href="../API-Security/">
      
      
        <link rel="next" href="../xss/">
      
      
        
      
      
      <link rel="icon" href="../../assets/a.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>WAHH - Ashok Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="deep-purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#vulnerability-report" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Ashok Documentation" class="md-header__button md-logo" aria-label="Ashok Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ashok Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              WAHH
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="deep-purple"  aria-label="Dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="deep-orange"  aria-label="Light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Ashok Documentation" class="md-nav__button md-logo" aria-label="Ashok Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Ashok Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../EmailSecurity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    EmailSecurity
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Formats/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Welcome to MkDocs
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Gym/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ðŸš€ Ashok's 30-Day Lean &amp; Chiseled Plan
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OKTA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Okta
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    AI Security
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    AI Security
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AI%20Security/Prompt%20Injection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Prompt Injection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    DevSecOps
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    DevSecOps
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DevSecOps/Kubernetes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    MobileSec
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    MobileSec
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MobileSec/Android/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Android Security
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MobileSec/Iphone/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Iphone Security
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MobileSec/Mobile-Security-Basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OWASP Mobile Top 10
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    ThreatModeling
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    ThreatModeling
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ThreatModeling/SecureDesign/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SecureDesign
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ThreatModeling/Threat-Modelling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Threat Modelling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" checked>
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Appsec
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Appsec
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API-Security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API Security
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    WAHH
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    WAHH
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#vulnerability-report" class="md-nav__link">
    <span class="md-ellipsis">
      
        Vulnerability Report
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Vulnerability Report">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-injection-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Injection Vulnerabilities
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Injection Vulnerabilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sql-injection" class="md-nav__link">
    <span class="md-ellipsis">
      
        SQL Injection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nosql-injection" class="md-nav__link">
    <span class="md-ellipsis">
      
        NoSQL Injection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xpath-injection" class="md-nav__link">
    <span class="md-ellipsis">
      
        XPath Injection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ldap-injection" class="md-nav__link">
    <span class="md-ellipsis">
      
        LDAP Injection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#os-command-injection" class="md-nav__link">
    <span class="md-ellipsis">
      
        OS Command Injection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script-injection-dynamic-execution" class="md-nav__link">
    <span class="md-ellipsis">
      
        Script Injection (Dynamic Execution)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#e-mail-header-manipulation-smtp-injection" class="md-nav__link">
    <span class="md-ellipsis">
      
        E-mail Header Manipulation (SMTP Injection)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#back-end-http-request-injection-hpihppserver-side-redirection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Back-End HTTP Request Injection (HPI/HPP/Server-Side Redirection)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xml-injection-xxe" class="md-nav__link">
    <span class="md-ellipsis">
      
        XML Injection (XXE)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#soap-injection" class="md-nav__link">
    <span class="md-ellipsis">
      
        SOAP Injection
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-cross-site-scripting-xss" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Cross-Site Scripting (XSS)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Cross-Site Scripting (XSS)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reflected-xss-non-persistent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reflected XSS (Non-Persistent)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stored-xss-persistent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stored XSS (Persistent)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dom-based-xss" class="md-nav__link">
    <span class="md-ellipsis">
      
        DOM-Based XSS
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-broken-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Broken Authentication
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Broken Authentication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#verbose-failure-messages-username-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verbose Failure Messages (Username Enumeration)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weakpredictable-passwords-brute-forcible-login" class="md-nav__link">
    <span class="md-ellipsis">
      
        Weak/Predictable Passwords &amp; Brute-Forcible Login
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerable-transmission-insecure-storage-of-credentials" class="md-nav__link">
    <span class="md-ellipsis">
      
        Vulnerable Transmission &amp; Insecure Storage of Credentials
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#incomplete-validation-of-credentials-logic-flaws-in-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      
        Incomplete Validation of Credentials / Logic Flaws in Authentication
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-broken-session-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Broken Session Management
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Broken Session Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#predictable-session-tokens" class="md-nav__link">
    <span class="md-ellipsis">
      
        Predictable Session Tokens
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#insecure-session-token-transmission-disclosure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Insecure Session Token Transmission &amp; Disclosure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#session-fixation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Session Fixation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-access-control-vulnerabilities-missing-function-level-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Access Control Vulnerabilities (Missing Function Level Access Control)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Access Control Vulnerabilities (Missing Function Level Access Control)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unprotected-functionality-vertical-privilege-escalation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unprotected Functionality (Vertical Privilege Escalation)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#insecure-direct-object-reference-horizontal-privilege-escalation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Insecure Direct Object Reference (Horizontal Privilege Escalation)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-security-misconfiguration" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Security Misconfiguration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-sensitive-data-exposure-cryptographic-flaws" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Sensitive Data Exposure (Cryptographic Flaws)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-cross-site-request-forgery-csrf" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. Cross-Site Request Forgery (CSRF)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-unvalidated-redirects-and-forwards" class="md-nav__link">
    <span class="md-ellipsis">
      
        9. Unvalidated Redirects and Forwards
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-application-logic-flaws" class="md-nav__link">
    <span class="md-ellipsis">
      
        10. Application Logic Flaws
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-native-code-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        11. Native Code Vulnerabilities
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="11. Native Code Vulnerabilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#buffer-overflows" class="md-nav__link">
    <span class="md-ellipsis">
      
        Buffer Overflows
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integer-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Integer Vulnerabilities
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#format-string-bugs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Format String Bugs
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-information-disclosure" class="md-nav__link">
    <span class="md-ellipsis">
      
        12. Information Disclosure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-cross-domain-data-capture-and-related-client-side-injections" class="md-nav__link">
    <span class="md-ellipsis">
      
        13. Cross-Domain Data Capture (and related Client-Side Injections)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13. Cross-Domain Data Capture (and related Client-Side Injections)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ui-redress-attacks-clickjackingstrokejacking" class="md-nav__link">
    <span class="md-ellipsis">
      
        UI Redress Attacks (Clickjacking/Strokejacking)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-side-cookie-injection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Client-Side Cookie Injection
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-shared-hosting-and-architecture-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        14. Shared Hosting and Architecture Vulnerabilities
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="14. Shared Hosting and Architecture Vulnerabilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inadequate-segregation-in-tiered-architectures" class="md-nav__link">
    <span class="md-ellipsis">
      
        Inadequate Segregation in Tiered Architectures
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-vulnerable-server-configuration-and-software" class="md-nav__link">
    <span class="md-ellipsis">
      
        15. Vulnerable Server Configuration and Software
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="15. Vulnerable Server Configuration and Software">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default-credentials-content" class="md-nav__link">
    <span class="md-ellipsis">
      
        Default Credentials &amp; Content
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-takeaways-best-practices-and-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Takeaways, Best Practices, and Patterns
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xss/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Xss
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#vulnerability-report" class="md-nav__link">
    <span class="md-ellipsis">
      
        Vulnerability Report
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Vulnerability Report">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-injection-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Injection Vulnerabilities
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Injection Vulnerabilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sql-injection" class="md-nav__link">
    <span class="md-ellipsis">
      
        SQL Injection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nosql-injection" class="md-nav__link">
    <span class="md-ellipsis">
      
        NoSQL Injection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xpath-injection" class="md-nav__link">
    <span class="md-ellipsis">
      
        XPath Injection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ldap-injection" class="md-nav__link">
    <span class="md-ellipsis">
      
        LDAP Injection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#os-command-injection" class="md-nav__link">
    <span class="md-ellipsis">
      
        OS Command Injection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script-injection-dynamic-execution" class="md-nav__link">
    <span class="md-ellipsis">
      
        Script Injection (Dynamic Execution)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#e-mail-header-manipulation-smtp-injection" class="md-nav__link">
    <span class="md-ellipsis">
      
        E-mail Header Manipulation (SMTP Injection)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#back-end-http-request-injection-hpihppserver-side-redirection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Back-End HTTP Request Injection (HPI/HPP/Server-Side Redirection)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xml-injection-xxe" class="md-nav__link">
    <span class="md-ellipsis">
      
        XML Injection (XXE)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#soap-injection" class="md-nav__link">
    <span class="md-ellipsis">
      
        SOAP Injection
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-cross-site-scripting-xss" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Cross-Site Scripting (XSS)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Cross-Site Scripting (XSS)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reflected-xss-non-persistent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reflected XSS (Non-Persistent)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stored-xss-persistent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stored XSS (Persistent)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dom-based-xss" class="md-nav__link">
    <span class="md-ellipsis">
      
        DOM-Based XSS
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-broken-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Broken Authentication
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Broken Authentication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#verbose-failure-messages-username-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verbose Failure Messages (Username Enumeration)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weakpredictable-passwords-brute-forcible-login" class="md-nav__link">
    <span class="md-ellipsis">
      
        Weak/Predictable Passwords &amp; Brute-Forcible Login
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerable-transmission-insecure-storage-of-credentials" class="md-nav__link">
    <span class="md-ellipsis">
      
        Vulnerable Transmission &amp; Insecure Storage of Credentials
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#incomplete-validation-of-credentials-logic-flaws-in-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      
        Incomplete Validation of Credentials / Logic Flaws in Authentication
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-broken-session-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Broken Session Management
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Broken Session Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#predictable-session-tokens" class="md-nav__link">
    <span class="md-ellipsis">
      
        Predictable Session Tokens
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#insecure-session-token-transmission-disclosure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Insecure Session Token Transmission &amp; Disclosure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#session-fixation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Session Fixation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-access-control-vulnerabilities-missing-function-level-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Access Control Vulnerabilities (Missing Function Level Access Control)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Access Control Vulnerabilities (Missing Function Level Access Control)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unprotected-functionality-vertical-privilege-escalation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unprotected Functionality (Vertical Privilege Escalation)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#insecure-direct-object-reference-horizontal-privilege-escalation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Insecure Direct Object Reference (Horizontal Privilege Escalation)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-security-misconfiguration" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Security Misconfiguration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-sensitive-data-exposure-cryptographic-flaws" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Sensitive Data Exposure (Cryptographic Flaws)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-cross-site-request-forgery-csrf" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. Cross-Site Request Forgery (CSRF)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-unvalidated-redirects-and-forwards" class="md-nav__link">
    <span class="md-ellipsis">
      
        9. Unvalidated Redirects and Forwards
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-application-logic-flaws" class="md-nav__link">
    <span class="md-ellipsis">
      
        10. Application Logic Flaws
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-native-code-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        11. Native Code Vulnerabilities
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="11. Native Code Vulnerabilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#buffer-overflows" class="md-nav__link">
    <span class="md-ellipsis">
      
        Buffer Overflows
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integer-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Integer Vulnerabilities
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#format-string-bugs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Format String Bugs
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-information-disclosure" class="md-nav__link">
    <span class="md-ellipsis">
      
        12. Information Disclosure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-cross-domain-data-capture-and-related-client-side-injections" class="md-nav__link">
    <span class="md-ellipsis">
      
        13. Cross-Domain Data Capture (and related Client-Side Injections)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13. Cross-Domain Data Capture (and related Client-Side Injections)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ui-redress-attacks-clickjackingstrokejacking" class="md-nav__link">
    <span class="md-ellipsis">
      
        UI Redress Attacks (Clickjacking/Strokejacking)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-side-cookie-injection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Client-Side Cookie Injection
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-shared-hosting-and-architecture-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        14. Shared Hosting and Architecture Vulnerabilities
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="14. Shared Hosting and Architecture Vulnerabilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inadequate-segregation-in-tiered-architectures" class="md-nav__link">
    <span class="md-ellipsis">
      
        Inadequate Segregation in Tiered Architectures
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-vulnerable-server-configuration-and-software" class="md-nav__link">
    <span class="md-ellipsis">
      
        15. Vulnerable Server Configuration and Software
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="15. Vulnerable Server Configuration and Software">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default-credentials-content" class="md-nav__link">
    <span class="md-ellipsis">
      
        Default Credentials &amp; Content
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-takeaways-best-practices-and-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Takeaways, Best Practices, and Patterns
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



  <h1>WAHH</h1>

<p>This report provides a comprehensive analysis of security vulnerabilities identified across two key cybersecurity documents: "OWASP Code Review Guide v2.pdf" and "The Web Application Hacker's Handbook.pdf." It aims to educate developers on various threat types, </p>
<hr />
<h2 id="vulnerability-report"><strong>Vulnerability Report</strong></h2>
<h3 id="1-injection-vulnerabilities"><strong>1. Injection Vulnerabilities</strong></h3>
<p>Injection vulnerabilities allow attackers to <strong>inject malicious content or commands into an application</strong>, modifying its intended behavior. These are common and often easy to exploit.</p>
<h4 id="sql-injection"><strong>SQL Injection</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> SQL Injection occurs when an attacker can submit crafted input to interfere with an application's interaction with <strong>back-end databases</strong>. This can lead to the disclosure or leaking of sensitive information, data integrity issues (modifying, adding, or deleting data), elevation of privileges, or gaining access to the back-end network. The core problem is that the SQL parser cannot distinguish between code and data when untrusted input is included in SQL statements.</p>
</li>
<li>
<p><strong>Vulnerable Code Example:</strong>
    Applications often construct SQL statements by concatenating user-supplied input directly into the query string without proper sanitization.
    <div class="language-java highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1">// Java example from OWASP Guide</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">HttpServletRequest</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">String</span><span class="w"> </span><span class="n">userName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getParameter</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">);</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">Connection</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...;</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">String</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SELECT * FROM Users WHERE name = &#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">userName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Vulnerable concatenation</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">con</span><span class="p">.</span><span class="na">execute</span><span class="p">(</span><span class="n">query</span><span class="p">);</span>
</span></code></pre></div>
    An attacker could input <code>"' OR 1=1"</code> for <code>userName</code>, making the query:
    <code>SELECT * FROM Users WHERE name = '' OR 1=1'</code>. This would return all user records.</p>
<p>Another example from "The Web Application Hacker's Handbook" for an ASP.NET application:
<div class="language-csharp highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1">// C# .NET example (representative, based on)</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="kt">string</span><span class="w"> </span><span class="n">employeeID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="n">getParameter</span><span class="p">(</span><span class="s">&quot;ei_id&quot;</span><span class="p">);</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="kt">string</span><span class="w"> </span><span class="n">sql</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SELECT name, lastname FROM authors WHERE ei_id = &#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">employeeID</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Vulnerable</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c1">// ... execute sql</span>
</span></code></pre></div>
An attacker could insert <code>"123';DROP TABLE pubs --"</code> for <code>employeeID</code>, executing <code>SELECT name, lastname FROM authors WHERE ei_id = '123'; DROP TABLE pubs --'</code>.</p>
</li>
<li>
<p><strong>Root Cause:</strong> The primary root cause is the <strong>unprotected concatenation of untrusted user input directly into SQL statements</strong>. This occurs because the SQL parser cannot distinguish between the developer's intended code and the malicious data injected by the attacker. Additionally, a <strong>lack of input validation or parameter mishandling</strong> can expose this flaw.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Parameterize SQL queries:</strong> This is considered one of the most effective ways to prevent SQL Injection. It involves using SQL methods provided by the programming language or framework that explicitly separate code from data.</li>
<li><strong>Use Stored Procedures:</strong> While generally helpful, stored procedures must be correctly implemented and not build dynamic SQL statements internally using untrusted input, as this can reintroduce the vulnerability.</li>
<li><strong>Input Validation:</strong> Always <strong>validate user input</strong> by testing type, length, format, and range. Accept only expected values and reject entries containing binary data, escape sequences, or comment characters. Implement <strong>multiple layers of validation</strong>.</li>
<li><strong>HtmlEncode all user input:</strong> This can mitigate some forms of injection, though it's not a complete solution for SQL injection specifically.</li>
<li><strong>Developer Training:</strong> Train developers in secure coding techniques to avoid common vulnerabilities.</li>
</ol>
</li>
<li>
<p><strong>Corrected Code Example:</strong>
    Using parameterized queries in Java:
    <div class="language-java highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1">// Java example with PreparedStatement from OWASP Guide</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">HttpServletRequest</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...;</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="n">String</span><span class="w"> </span><span class="n">userName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getParameter</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">);</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="n">Connection</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...;</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="n">String</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SELECT * FROM Users WHERE name = ?&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Use a placeholder</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="n">PreparedStatement</span><span class="w"> </span><span class="n">pstmt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">con</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="n">query</span><span class="p">);</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="n">pstmt</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">userName</span><span class="p">);</span><span class="w"> </span><span class="c1">// Set parameter safely</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="n">ResultSet</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pstmt</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">();</span>
</span></code></pre></div>
    Using parameterized queries in .NET:
    <div class="language-csharp highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1">// C# .NET example (representative, based on)</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="k">using</span><span class="w"> </span><span class="p">(</span><span class="n">SqlConnection</span><span class="w"> </span><span class="n">conn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SqlConnection</span><span class="p">(</span><span class="n">connectionString</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">    </span><span class="n">DataSet</span><span class="w"> </span><span class="n">dataObj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DataSet</span><span class="p">();</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">    </span><span class="n">SqlDataAdapter</span><span class="w"> </span><span class="n">sqlAdapter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SqlDataAdapter</span><span class="p">(</span><span class="s">&quot;StoredProc&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">conn</span><span class="p">);</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">    </span><span class="n">sqlAdapter</span><span class="p">.</span><span class="n">SelectCommand</span><span class="p">.</span><span class="n">CommandType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">StoredProcedure</span><span class="p">;</span><span class="w"> </span><span class="c1">// Or CommandType.Text for direct query</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">    </span><span class="n">sqlAdapter</span><span class="p">.</span><span class="n">SelectCommand</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&quot;@usrId&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">SqlDbType</span><span class="p">.</span><span class="n">VarChar</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">);</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">    </span><span class="n">sqlAdapter</span><span class="p">.</span><span class="n">SelectCommand</span><span class="p">.</span><span class="n">Parameters</span><span class="p">[</span><span class="s">&quot;@usrId&quot;</span><span class="p">].</span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UID</span><span class="p">.</span><span class="n">Text</span><span class="p">;</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">    </span><span class="c1">// ... execute</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Explanation of Fix:</strong> <strong>Parameterized queries (and correctly implemented stored procedures)</strong> explicitly tell the database engine which parts of the statement are code and which are data, preventing the attacker's input from being interpreted as executable SQL. The database treats the user-supplied value as a literal string, even if it contains SQL syntax. <strong>Strict input validation</strong> reduces the attack surface by ensuring that only data conforming to expected types and formats is processed, further limiting an attacker's ability to craft malicious inputs.</p>
</li>
</ul>
<h4 id="nosql-injection"><strong>NoSQL Injection</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> NoSQL injection vulnerabilities arise in applications using NoSQL data stores (which break from standard relational database architectures and use key/value mappings without a fixed schema). Similar to SQL injection, these allow attackers to interfere with how the application processes data in NoSQL databases.</p>
</li>
<li>
<p><strong>Vulnerable Code Example:</strong> (Representative, based on's explanation of MongoDB injection)
    <div class="language-javascript highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1">// JavaScript (Node.js/MongoDB) example</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="nx">router</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/products&#39;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="nx">res</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">        </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">category</span><span class="w"> </span><span class="c1">// User-controlled input</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">    </span><span class="nx">db</span><span class="p">.</span><span class="nx">collection</span><span class="p">(</span><span class="s1">&#39;products&#39;</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="nx">query</span><span class="p">).</span><span class="nx">toArray</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">docs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">        </span><span class="c1">// ... process results</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="p">});</span>
</span></code></pre></div>
    An attacker might send <code>?category[$ne]=null</code> as input, which for some NoSQL databases might alter the query's logic to return all documents where the category is not null.</p>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is similar to SQL injection: <strong>unsafe incorporation of user-supplied data into queries or commands executed by the NoSQL database</strong>. This is compounded by the flexible, schema-less nature of NoSQL, which can sometimes lead developers to be less rigorous with input handling compared to traditional SQL.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Use specific API functions for queries:</strong> Most NoSQL databases provide APIs that distinguish between data and commands.</li>
<li><strong>Strict Input Validation:</strong> Implement rigorous validation for all user input that interacts with the NoSQL database.</li>
<li><strong>Sanitization:</strong> Ensure proper sanitization of input, especially for dynamic queries.</li>
</ol>
</li>
<li>
<p><strong>Explanation of Fix:</strong> Using <strong>specific API functions</strong> helps ensure that user input is treated as literal data and not as part of the query structure, thus preventing code execution. <strong>Strict input validation and sanitization</strong> further reduce the risk by disallowing malicious characters or structures from reaching the database layer.</p>
</li>
</ul>
<h4 id="xpath-injection"><strong>XPath Injection</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> XPath injection vulnerabilities occur when user-supplied input is incorporated unsafely into XPath queries, which are used to navigate XML documents. This can allow an attacker to bypass application logic or extract arbitrary data from XML data stores.</p>
</li>
<li>
<p><strong>Vulnerable Code Example:</strong> (Representative, based on's concept of informed XPath injection)
    <div class="language-java highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1">// Java example (representative)</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="n">String</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getParameter</span><span class="p">(</span><span class="s">&quot;username&quot;</span><span class="p">);</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getParameter</span><span class="p">(</span><span class="s">&quot;password&quot;</span><span class="p">);</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="n">String</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;/users/user[username=&#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&#39; and password=&#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&#39;]&quot;</span><span class="p">;</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="c1">// ... execute XPath query against an XML document</span>
</span></code></pre></div>
    An attacker could input <code>"' or '1'='1"</code> for <code>username</code>, bypassing authentication.</p>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is the <strong>direct concatenation of user-supplied data into XPath query strings without proper escaping or validation</strong>, allowing an attacker to manipulate the query's logic.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Use Parameterized XPath Queries:</strong> Employ APIs that allow parameters to be bound to XPath expressions, treating input as data.</li>
<li><strong>Whitelist Validation:</strong> For dynamic parts of the query (e.g., element names), use a whitelist approach to ensure only expected values are used.</li>
<li><strong>Escape Special Characters:</strong> Properly escape all XPath metacharacters within user input before inclusion in queries.</li>
</ol>
</li>
<li>
<p><strong>Explanation of Fix:</strong> <strong>Parameterized queries and proper escaping</strong> ensure that user input cannot alter the structure or meaning of the XPath expression, preventing injection. <strong>Whitelisting</strong> restricts dynamic parts of queries to safe, predefined values.</p>
</li>
</ul>
<h4 id="ldap-injection"><strong>LDAP Injection</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> LDAP (Lightweight Directory Access Protocol) injection arises when user-supplied input is embedded directly into LDAP queries without proper sanitization. This can allow attackers to bypass authentication, retrieve unauthorized information from directory services (like Active Directory), or subvert application logic.</p>
</li>
<li>
<p><strong>Vulnerable Code Example:</strong> (Representative, based on's example)
    <div class="language-java highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1">// Java example (representative)</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="n">String</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getParameter</span><span class="p">(</span><span class="s">&quot;username&quot;</span><span class="p">);</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getParameter</span><span class="p">(</span><span class="s">&quot;password&quot;</span><span class="p">);</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="n">String</span><span class="w"> </span><span class="n">ldapFilter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;(&amp;(uid=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;)(userPassword=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;))&quot;</span><span class="p">;</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="c1">// ... search LDAP directory with ldapFilter</span>
</span></code></pre></div>
    An attacker could submit <code>*)(objectClass=*)</code> for <code>username</code>, which might modify the filter to <code>(&amp;(uid=*)(objectClass=*))(userPassword=...))</code> allowing arbitrary access.</p>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is the <strong>unsafe direct inclusion of user input into LDAP filters or queries</strong>, without proper escaping of LDAP special characters (e.g., <code>*</code>, <code>(</code>, <code>)</code>, <code>=</code>, <code>,</code>).</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Escape LDAP Special Characters:</strong> Implement rigorous escaping for all user-supplied data that will be used in LDAP queries.</li>
<li><strong>Use Parameterized APIs:</strong> Utilize LDAP APIs that support parameterized queries, similar to prepared statements in SQL.</li>
<li><strong>Strict Input Validation:</strong> Validate input against a whitelist of allowed characters or expected patterns.</li>
</ol>
</li>
<li>
<p><strong>Explanation of Fix:</strong> <strong>Escaping LDAP metacharacters</strong> ensures that user input is treated as literal data and not as control characters that could alter the LDAP query's structure. <strong>Parameterized APIs</strong> provide a secure separation between query logic and user data.</p>
</li>
</ul>
<h4 id="os-command-injection"><strong>OS Command Injection</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> OS Command Injection allows an attacker to execute arbitrary operating system commands on the server running the web application. This happens when an application incorporates user-supplied input into commands that are passed to an underlying operating system shell. A successful attack can lead to full compromise of the underlying operating system.</p>
</li>
<li>
<p><strong>Vulnerable Code Example:</strong>
    <div class="language-csharp highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1">// C# ASP.NET example from Web Application Hacker&#39;s Handbook</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="kt">string</span><span class="w"> </span><span class="n">dirName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;C:\\filestore\\&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Directory</span><span class="p">.</span><span class="n">Text</span><span class="p">;</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="n">ProcessStartInfo</span><span class="w"> </span><span class="n">psInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ProcessStartInfo</span><span class="p">(</span><span class="s">&quot;cmd&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/c dir &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dirName</span><span class="p">);</span><span class="w"> </span><span class="c1">// Vulnerable concatenation</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="n">Process</span><span class="w"> </span><span class="n">proc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Process</span><span class="p">.</span><span class="n">Start</span><span class="p">(</span><span class="n">psInfo</span><span class="p">);</span>
</span></code></pre></div>
    An attacker could input <code>&amp; dir C:\ --</code> to <code>Directory.Text</code>, which would execute <code>cmd /c dir C:\filestore\ &amp; dir C:\ --</code>, leading to <code>dir C:\</code> being executed.</p>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is the <strong>direct concatenation of untrusted user input into system commands</strong> that are executed by functions like <code>Process.Start</code> (C#), <code>Runtime.exec</code> (Java), or <code>system</code> (PHP/Perl). The application fails to properly separate the command from its arguments or data.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Avoid Shell Execution:</strong> Do not pass user-supplied input, or data derived from it, into any dynamic execution or shell-level command functions if at all possible.</li>
<li><strong>Use Specific APIs:</strong> If external processes must be launched, use APIs that allow command arguments to be passed as separate parameters (e.g., <code>ProcessStartInfo.Arguments</code> in C#, <code>ProcessBuilder</code> in Java), which prevents shell metacharacters from being interpreted.</li>
<li><strong>Whitelist Validation:</strong> If dynamic command parts are unavoidable, use a strict whitelist of known good values and reject any input not matching this list.</li>
<li><strong>Least Privilege:</strong> Configure the application to run with the least possible operating system privileges.</li>
</ol>
</li>
<li>
<p><strong>Corrected Code Example:</strong>
    Using arguments array in C#:
    <div class="language-csharp highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1">// C# ASP.NET example with safe argument passing (representative)</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="kt">string</span><span class="w"> </span><span class="n">dirName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Directory</span><span class="p">.</span><span class="n">Text</span><span class="p">;</span><span class="w"> </span><span class="c1">// User input</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="c1">// Ensure dirName itself does not contain malicious paths or commands if it needs to be part of the command&#39;s target</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="n">ProcessStartInfo</span><span class="w"> </span><span class="n">psInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ProcessStartInfo</span><span class="p">(</span><span class="s">&quot;cmd.exe&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/c dir &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Process</span><span class="p">.</span><span class="n">EscapeArgument</span><span class="p">(</span><span class="n">dirName</span><span class="p">));</span><span class="w"> </span><span class="c1">// Safer</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="c1">// For more complex commands or variable inputs, pass arguments separately:</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="c1">// ProcessStartInfo psInfo = new ProcessStartInfo(&quot;cmd.exe&quot;);</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="c1">// psInfo.Arguments = &quot;/c dir \&quot;&quot; + dirName + &quot;\&quot;&quot;; // Escape the path or ensure it&#39;s safe</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="n">Process</span><span class="w"> </span><span class="n">proc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Process</span><span class="p">.</span><span class="n">Start</span><span class="p">(</span><span class="n">psInfo</span><span class="p">);</span>
</span></code></pre></div>
    Using <code>ProcessBuilder</code> in Java:
    <div class="language-java highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1">// Java example with ProcessBuilder (representative)</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="n">String</span><span class="w"> </span><span class="n">userName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getParameter</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">);</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="n">ProcessBuilder</span><span class="w"> </span><span class="n">pb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ProcessBuilder</span><span class="p">(</span><span class="s">&quot;cmd.exe&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/c&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;echo&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">userName</span><span class="p">);</span><span class="w"> </span><span class="c1">// Arguments as separate strings</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="n">pb</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Explanation of Fix:</strong> <strong>Avoiding direct shell execution</strong> where user input can manipulate commands is the best defense. When direct execution is unavoidable, passing arguments as <strong>separate parameters to specific APIs</strong> prevents the shell from interpreting user-supplied metacharacters (like <code>&amp;</code>, <code>|</code>, <code>;</code>) as new commands, treating them instead as literal parts of an argument. <strong>Whitelisting</strong> provides a strong layer of control over accepted inputs.</p>
</li>
</ul>
<h4 id="script-injection-dynamic-execution"><strong>Script Injection (Dynamic Execution)</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> Script injection occurs when an application dynamically executes code that is generated at runtime, and user input is incorporated into this code. Attackers can supply crafted input that breaks out of the intended data context and specifies commands to be executed on the server. This is distinct from XSS, as it targets server-side scripting languages.</p>
</li>
<li>
<p><strong>Vulnerable Code Example:</strong> (Representative, based on PHP/Perl <code>eval()</code> and Classic ASP <code>Execute()</code> examples in)
    <div class="language-php highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="x">// PHP example (representative)</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="x">$mysearch = $_GET[&#39;search_query&#39;];</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="x">eval(&quot;\$result = &quot; . $mysearch . &quot;;&quot;); // Vulnerable if $mysearch contains executable code</span>
</span></code></pre></div>
    If <code>$mysearch</code> is <code>wahh; system('cat /etc/passwd')</code>, it would execute <code>system('cat /etc/passwd')</code>.</p>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is the <strong>passing of user-supplied input, or data derived from it, into dynamic execution or include functions</strong> of scripting languages. These functions interpret concatenated strings as executable code, rather than literal data.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Avoid Dynamic Execution of User Input:</strong> The best way to prevent script injection is to <strong>never pass user-supplied input into dynamic execution or include functions</strong>.</li>
<li><strong>Strict Input Validation:</strong> If such functions are absolutely unavoidable, the relevant input should be <strong>strictly validated</strong> using a whitelist of known good values. Reject any input that does not appear on this list or contains characters known to be harmful.</li>
</ol>
</li>
<li>
<p><strong>Explanation of Fix:</strong> <strong>Not using dynamic execution functions with user input</strong> removes the interpreter's ability to execute malicious code. When unavoidable, <strong>strict whitelisting</strong> ensures that only safe, predefined inputs are processed, effectively preventing an attacker from introducing executable syntax.</p>
</li>
</ul>
<h4 id="e-mail-header-manipulation-smtp-injection"><strong>E-mail Header Manipulation (SMTP Injection)</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> SMTP Injection occurs when an attacker manipulates email headers by injecting CRLF (carriage return/line feed) characters into user-supplied input used to construct an email. This can allow attackers to send arbitrary emails, spam, or even bypass security controls by injecting additional headers.</p>
</li>
<li>
<p><strong>Vulnerable Code Example:</strong> (Representative, based on's description)
    <div class="language-java highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1">// Java example (representative)</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="n">String</span><span class="w"> </span><span class="n">recipient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getParameter</span><span class="p">(</span><span class="s">&quot;to&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// User-supplied recipient</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="c1">// ... construct email</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="n">Message</span><span class="w"> </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MimeMessage</span><span class="p">(</span><span class="n">session</span><span class="p">);</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="n">msg</span><span class="p">.</span><span class="na">setRecipients</span><span class="p">(</span><span class="n">Message</span><span class="p">.</span><span class="na">RecipientType</span><span class="p">.</span><span class="na">TO</span><span class="p">,</span><span class="w"> </span><span class="n">InternetAddress</span><span class="p">.</span><span class="na">parse</span><span class="p">(</span><span class="n">recipient</span><span class="p">));</span><span class="w"> </span><span class="c1">// Vulnerable if recipient contains CRLF</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="c1">// ... send email</span>
</span></code></pre></div>
    An attacker might input <code>attacker@example.com%0aBcc:spam@example.com</code> to inject a Bcc header.</p>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is the <strong>failure to validate user input for newline characters (CRLF)</strong> before incorporating it into email headers. SMTP and mail libraries interpret these characters as separators for new headers or body content, allowing injection.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Validate User Input for Newlines:</strong> Strictly validate user-supplied email inputs to ensure they do not contain any newline characters (CR and LF, <code>%0d</code> and <code>%0a</code>) or other SMTP metacharacters.</li>
<li><strong>Use Specific API Methods:</strong> Use mail APIs that properly handle or escape user input for email addresses and content.</li>
</ol>
</li>
<li>
<p><strong>Explanation of Fix:</strong> <strong>Removing or encoding newline characters</strong> (<code>%0a</code>, <code>%0d</code>) from user input prevents the mail server from interpreting them as new headers or commands. This ensures that user input remains within its intended data field.</p>
</li>
</ul>
<h4 id="back-end-http-request-injection-hpihppserver-side-redirection"><strong>Back-End HTTP Request Injection (HPI/HPP/Server-Side Redirection)</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> These vulnerabilities occur when an application constructs internal (server-side) HTTP requests using user-supplied data without proper validation or sanitization.</p>
<ul>
<li><strong>HTTP Parameter Injection (HPI):</strong> Injecting parameters into the server's internal HTTP request.</li>
<li><strong>HTTP Parameter Pollution (HPP):</strong> Supplying multiple parameters with the same name, which may be handled differently by various components of the application.</li>
<li><strong>Server-Side HTTP Redirection:</strong> When a server-side component (e.g., a proxy, an internal redirect) constructs a new HTTP request based on user-supplied URL fragments, allowing an attacker to control the destination.</li>
</ul>
</li>
<li>
<p><strong>Vulnerable Code Example:</strong>
    A classic example of server-side HTTP redirection (representative, based on)
    <div class="language-java highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1">// Java example (representative)</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="n">String</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getParameter</span><span class="p">(</span><span class="s">&quot;redirect_url&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// User-controlled URL</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="n">URL</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">URL</span><span class="p">(</span><span class="n">url</span><span class="p">);</span><span class="w"> </span><span class="c1">// Vulnerable if &#39;url&#39; can be manipulated</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="n">HttpURLConnection</span><span class="w"> </span><span class="n">conn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">HttpURLConnection</span><span class="p">)</span><span class="w"> </span><span class="n">target</span><span class="p">.</span><span class="na">openConnection</span><span class="p">();</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="c1">// ... fetch content from &#39;target&#39;</span>
</span></code></pre></div>
    An attacker could submit <code>http://internal-host/admin</code> to access an internal service.</p>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is the <strong>unvalidated or unsanitized inclusion of user-supplied data into the URL or parameters of internal HTTP requests</strong>. Different components (e.g., web server, application framework, back-end service) might interpret the same string differently, leading to unintended behavior.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Whitelist Destinations:</strong> For redirects and forwards, only allow destinations that are explicitly defined in a whitelist.</li>
<li><strong>Use Relative Paths:</strong> Prefer using relative paths for redirects and forwards to ensure they stay on the trusted site.</li>
<li><strong>Strict Input Validation:</strong> Ensure user-supplied scheme name or authority section of URLs are thoroughly validated, allowing only necessary prefixes, alphanumerics, hyphens, and periods.</li>
<li><strong>Avoid Assumptions:</strong> Do not assume default browser behavior will properly escape characters.</li>
</ol>
</li>
<li>
<p><strong>Explanation of Fix:</strong> <strong>Whitelisting destinations and using relative paths</strong> severely restricts an attacker's ability to redirect to arbitrary external or internal locations. <strong>Strict input validation</strong> ensures that only safe characters and structures are permitted in dynamic URL parts, preventing injection of malicious components.</p>
</li>
</ul>
<h4 id="xml-injection-xxe"><strong>XML Injection (XXE)</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> XML External Entity (XXE) injection is a type of XML injection that occurs when an XML parser processes XML input containing references to external entities (URIs) that are not properly secured. This can allow attackers to read local files, execute OS commands, perform server-side request forgery (SSRF), or launch denial-of-service attacks.</p>
</li>
<li>
<p><strong>Vulnerable Code Example:</strong> (Representative, based on's concept)
    <div class="language-xml highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="cp">&lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot;&gt;</span><span class="w"> </span>]&gt;
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="nt">&lt;data&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/data&gt;</span>
</span></code></pre></div>
    If an application parses this XML and renders the <code>data</code> element, it might display the content of <code>/etc/passwd</code>.</p>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is the <strong>improper configuration of XML parsers</strong>, which by default often allow the resolution and processing of external entities. When these parsers receive user-controlled XML input, they can be tricked into fetching and including external content, or even executing commands.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Disable External Entities:</strong> The most effective remediation is to <strong>disable the processing of external entities</strong> in the XML parser configuration.</li>
<li><strong>Disable DTD Processing:</strong> Disabling DTD (Document Type Definition) processing can also prevent XXE attacks.</li>
<li><strong>Use Whitelisting for DTDs:</strong> If DTDs are necessary, use a whitelist for allowed DTDs.</li>
<li><strong>Input Validation:</strong> Validate XML input against a schema and reject any malformed or unexpected structures.</li>
</ol>
</li>
<li>
<p><strong>Explanation of Fix:</strong> <strong>Disabling external entity processing</strong> directly prevents the XML parser from resolving and including external content, thereby mitigating the core XXE vulnerability. This ensures that even if an attacker provides external entity definitions, they will not be processed.</p>
</li>
</ul>
<h4 id="soap-injection"><strong>SOAP Injection</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> SOAP (Simple Object Access Protocol) injection vulnerabilities occur when user-supplied data is incorporated directly into back-end SOAP messages without proper sanitization. Attackers can inject XML metacharacters or SOAP-specific syntax to alter the message structure, potentially bypassing application logic or accessing unauthorized data.</p>
</li>
<li>
<p><strong>Vulnerable Code Example:</strong> (Representative, based on's explanation)
    Consider a SOAP message for adding an item, where the item description is user-controlled:
    <div class="language-xml highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="nt">&lt;soap:Envelope</span><span class="w"> </span><span class="na">xmlns:soap=</span><span class="s">&quot;http://www.w3.org/2003/05/soap-envelope&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="w">    </span><span class="nt">&lt;soap:Body&gt;</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">        </span><span class="nt">&lt;m:AddItem</span><span class="w"> </span><span class="na">xmlns:m=</span><span class="s">&quot;http://example.com/products&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w">            </span><span class="nt">&lt;m:Description&gt;</span>User<span class="w"> </span>supplied<span class="w"> </span>description<span class="w"> </span>here<span class="nt">&lt;/m:Description&gt;</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w">        </span><span class="nt">&lt;/m:AddItem&gt;</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="w">    </span><span class="nt">&lt;/soap:Body&gt;</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="nt">&lt;/soap:Envelope&gt;</span>
</span></code></pre></div>
    If <code>User supplied description here</code> is <code>&lt;/m:Description&gt;&lt;m:Price&gt;0&lt;/m:Price&gt;</code>, an attacker might inject a price.</p>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is the <strong>direct concatenation of unvalidated or unsanitized user input into the XML structure of SOAP messages</strong>. This allows attackers to manipulate the XML, leading to unintended processing by the SOAP service.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>XML Encoding:</strong> Properly encode all user input that will be inserted into SOAP messages.</li>
<li><strong>Use APIs for XML Construction:</strong> Utilize XML parsing and construction libraries that handle escaping automatically rather than manually building XML strings.</li>
<li><strong>Schema Validation:</strong> Validate incoming SOAP messages against their WSDL-defined schema.</li>
</ol>
</li>
<li>
<p><strong>Explanation of Fix:</strong> <strong>Proper XML encoding</strong> ensures that user input is treated as literal text within XML elements and not as new XML tags or attributes. Using <strong>XML construction APIs</strong> helps automate this process securely.</p>
</li>
</ul>
<hr />
<h3 id="2-cross-site-scripting-xss"><strong>2. Cross-Site Scripting (XSS)</strong></h3>
<p>Cross-site scripting (XSS) is a common web application vulnerability that enables attackers to inject malicious script into web pages viewed by other users. This can allow attackers to bypass access controls (like the same-origin policy), gain access to user data, perform unauthorized actions on their behalf, or carry out other attacks.</p>
<h4 id="reflected-xss-non-persistent"><strong>Reflected XSS (Non-Persistent)</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> Reflected XSS occurs when user-supplied data is <strong>immediately returned or "reflected"</strong> in the application's HTTP response without proper sanitization. The malicious script is delivered via a crafted URL or request, which, when clicked or processed, executes in the victim's browser.</p>
</li>
<li>
<p><strong>Vulnerable Code Example:</strong>
    <div class="language-html highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="cm">&lt;!-- HTML example from OWASP Guide --&gt;</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;fname&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;UNTRUSTED DATA&quot;</span><span class="p">&gt;</span>
</span></code></pre></div>
    If <code>UNTRUSTED DATA</code> comes directly from a URL parameter like <code>?fname="&gt;&lt;script&gt;alert(1)&lt;/script&gt;</code>, the rendered HTML becomes:
    <code>&lt;input type="text" name="fname" value=""&gt;&lt;script&gt;alert(1)&lt;/script&gt;"&gt;</code>. The attacker's script then executes.</p>
<p>Another example might be an error page reflecting user input:
<div class="language-php highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="x">// PHP example (representative, based on)</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="x">echo &quot;Error: Invalid input &quot; . $_GET[&#39;message&#39;];</span>
</span></code></pre></div>
If <code>$_GET['message']</code> is <code>&lt;script&gt;alert('XSS')&lt;/script&gt;</code>, the script executes in the user's browser.</p>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is the <strong>failure to perform output encoding or sanitization on user-supplied data before it is inserted into the HTML output</strong>. The application trusts that the reflected input is benign and embeds it directly into the page.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Output Encoding (Context-Sensitive):</strong> The most crucial defense. <strong>Encode all user-supplied data</strong> based on the context in which it will be displayed in the HTML. For HTML attributes, use <code>&amp;#xHH;</code> format (or named entities). For HTML body, encode <code>&amp;</code>, <code>&lt;</code>, <code>&gt;</code>, <code>"</code>, <code>'</code>, and <code>/</code>.</li>
<li><strong>Input Validation:</strong> While not a primary defense for output, <strong>validating input</strong> (e.g., length, character sets) can reduce the attack surface.</li>
<li><strong>Content Security Policy (CSP):</strong> Implement a robust CSP header to restrict where scripts can be loaded from and executed [498 (implied by "Potential solutions: OWASP HTML Sanitizer Project")].</li>
<li><strong>Client-Side Sanitizers (OWASP HTML Sanitizer):</strong> Use libraries to sanitize HTML content.</li>
</ol>
</li>
<li>
<p><strong>Corrected Code Example:</strong>
    Using HTML attribute encoding for the input <code>value</code>:
    <div class="language-html highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="cm">&lt;!-- Corrected HTML example (representative, based on) --&gt;</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;fname&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;&amp;#x22;&amp;#x3e;&amp;#x3c;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;&amp;#x3e;&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;&amp;#x3c;&amp;#x2f;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;&amp;#x3e;&quot;</span><span class="p">&gt;</span>
</span></code></pre></div>
    Using encoding functions (e.g., from OWASP ESAPI or Java Encoder):
    <div class="language-java highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1">// Java example with encoding (representative, based on)</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="n">String</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getParameter</span><span class="p">(</span><span class="s">&quot;message&quot;</span><span class="p">);</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="c1">// org.owasp.esapi.ESAPI.encoder().encodeForHTML() or encodeForHTMLAttribute()</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="c1">// For HTML body:</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Error: Invalid input &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ESAPI</span><span class="p">.</span><span class="na">encoder</span><span class="p">().</span><span class="na">encodeForHTML</span><span class="p">(</span><span class="n">message</span><span class="p">));</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="c1">// For HTML attribute:</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="c1">// &lt;input value=&#39;&quot; + ESAPI.encoder().encodeForHTMLAttribute(message) + &quot;&#39;&gt;</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Explanation of Fix:</strong> <strong>Output encoding</strong> transforms characters that have special meaning in HTML (like <code>&lt;</code> and <code>&gt;</code>) into their entity equivalents (like <code>&amp;lt;</code> and <code>&amp;gt;</code>). This ensures that the browser interprets the user's input as literal text rather than executable code. By consistently encoding based on the output context (HTML element content, attribute value, JavaScript string, etc.), the application prevents the attacker's script from breaking out of its intended context and executing.</p>
</li>
</ul>
<h4 id="stored-xss-persistent"><strong>Stored XSS (Persistent)</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> Stored XSS occurs when malicious user-supplied data is <strong>permanently stored</strong> by the application (e.g., in a database) and later retrieved and displayed to other users without proper sanitization. This is often considered more serious than reflected XSS because the malicious payload is "stored" and can affect multiple users over time without further attacker interaction.</p>
</li>
<li>
<p><strong>Vulnerable Code Example:</strong> (Representative, based on's explanation)
    Consider a message board where users can post comments. If comments are stored and then retrieved, the following could be vulnerable:
    <div class="language-php highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="x">// PHP example (representative)</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="x">// When storing:</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="x">$comment = $_POST[&#39;comment&#39;]; // Attacker inserts &lt;script&gt;alert(&#39;Stored XSS&#39;)&lt;/script&gt;</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="x">// ... store $comment in database</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="x">// When displaying:</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="x">$stored_comment = getCommentFromDB();</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="x">echo &quot;&lt;p&gt;&quot; . $stored_comment . &quot;&lt;/p&gt;&quot;; // Vulnerable, directly echoes stored content</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is the <strong>failure to perform output encoding or sanitization when retrieving and displaying user-supplied data that was previously stored</strong>. The application assumes that data once stored is safe, or that sanitization happened only upon input, neglecting to sanitize upon output, where the context of display might differ.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Output Encoding (Context-Sensitive):</strong> As with reflected XSS, the most critical defense is to <strong>encode all user-supplied data based on the context of its display in the HTML output</strong>, whenever it is retrieved from storage. This includes <code>&amp;</code>, <code>&lt;</code>, <code>&gt;</code>, <code>"</code>, <code>'</code>, and <code>/</code> for HTML body, and <code>&amp;#xHH;</code> for attributes.</li>
<li><strong>Input Validation/Sanitization:</strong> While output encoding is paramount, filtering and sanitizing input before storage can add a layer of defense. However, <strong>do not rely solely on input filtering</strong>, as output context can vary. If HTML content is legitimately allowed, use an HTML sanitization library (e.g., OWASP HTML Sanitizer Project) to remove dangerous tags and attributes.</li>
</ol>
</li>
<li>
<p><strong>Explanation of Fix:</strong> The core principle remains <strong>output encoding at the point of display</strong>. By transforming special characters into their harmless HTML entity equivalents just before they are rendered in the browser, the application ensures that the stored malicious script is displayed as text, not executed as code. This is a "defense-in-depth" approach, recognizing that input filters can be bypassed or that data might originate from different, less-controlled sources.</p>
</li>
</ul>
<h4 id="dom-based-xss"><strong>DOM-Based XSS</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> DOM-based XSS occurs entirely on the client-side when a JavaScript application modifies the page's DOM (Document Object Model) using attacker-controlled data, without proper sanitization. The malicious script is executed as a result of client-side code manipulating a part of the DOM, rather than the server reflecting or storing the payload.</p>
</li>
<li>
<p><strong>Vulnerable Code Example:</strong>
    <div class="language-html highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="cm">&lt;!-- HTML with JavaScript example from OWASP Guide --&gt;</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="w">    </span><span class="kd">function</span><span class="w"> </span><span class="nx">setWelcomeMessage</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">hash</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span><span class="w"> </span><span class="c1">// User-controlled part of URL</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="w">        </span><span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="s2">&quot;Welcome &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;!&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// Vulnerable sink</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="w">    </span><span class="nx">setWelcomeMessage</span><span class="p">();</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></code></pre></div>
    If the URL is <code>http://hostname/welcome.html#name=&lt;script&gt;alert(1)&lt;/script&gt;</code>, the script in the hash is read by JavaScript and written to the DOM, executing <code>alert(1)</code>.</p>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is <strong>client-side JavaScript directly using untrusted data from the DOM (e.g., <code>document.location</code>, <code>window.location</code>, <code>document.URL</code>, <code>document.referrer</code>) to modify the HTML DOM without proper sanitization or encoding</strong>. This allows an attacker to inject script that is then interpreted and executed by the browser.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Client-Side Sanitization/Encoding:</strong> All untrusted data that modifies the DOM must be <strong>sanitized or encoded before being written to the DOM</strong>. Use JavaScript encoding functions (e.g., <code>ESAPI.encoder().encodeForJavaScript()</code>) or HTML sanitizers on the client side.</li>
<li><strong>Avoid Dangerous JavaScript Functions:</strong> Avoid functions like <code>eval()</code>, <code>document.write()</code>, <code>document.writeln()</code>, <code>innerHTML</code>, <code>setTimeout()</code>, <code>setInterval()</code> when processing untrusted data, as they are common sinks for DOM-based XSS.</li>
<li><strong>Use Safe DOM Manipulation:</strong> Prefer safe DOM manipulation methods like <code>textContent</code> or <code>createElement</code> combined with <code>appendChild</code> instead of <code>innerHTML</code> when inserting untrusted data.</li>
<li><strong>Static Analysis Tools:</strong> Use static analysis tools with taint analysis to identify data flows from sources to sinks.</li>
</ol>
</li>
<li>
<p><strong>Corrected Code Example:</strong>
    Using safe DOM manipulation (representative):
    <div class="language-html highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="cm">&lt;!-- Corrected HTML with JavaScript example (representative) --&gt;</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;welcomeDiv&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="w">    </span><span class="kd">function</span><span class="w"> </span><span class="nx">setWelcomeMessage</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">hash</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span><span class="w"> </span><span class="c1">// Still user-controlled source</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">welcomeDiv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;welcomeDiv&quot;</span><span class="p">);</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="w">        </span><span class="c1">// Safely set text content, not HTML</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="w">        </span><span class="nx">welcomeDiv</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Welcome &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;!&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Safest sink</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="w">        </span><span class="c1">// Alternatively, if HTML is needed and sanitized:</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="w">        </span><span class="c1">// welcomeDiv.innerHTML = DOMPurify.sanitize(&quot;Welcome &quot; + name + &quot;!&quot;); // Using a sanitizer library</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="w">    </span><span class="nx">setWelcomeMessage</span><span class="p">();</span>
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Explanation of Fix:</strong> By using <strong>safe DOM manipulation methods</strong> like <code>textContent</code>, the browser treats any injected HTML or script as literal text, preventing it from being parsed and executed as code. Avoiding dangerous functions and implementing client-side sanitization libraries ensures that even if user input reaches a DOM manipulation function, it is rendered harmlessly.</p>
</li>
</ul>
<hr />
<h3 id="3-broken-authentication"><strong>3. Broken Authentication</strong></h3>
<p>Broken Authentication encompasses various vulnerabilities related to the <strong>improper implementation or design of authentication mechanisms</strong>, allowing attackers to bypass authentication, impersonate legitimate users, or gain unauthorized access to accounts.</p>
<h4 id="verbose-failure-messages-username-enumeration"><strong>Verbose Failure Messages (Username Enumeration)</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> Verbose failure messages disclose different responses (error messages, HTTP status codes, response lengths, or subtle HTML differences) depending on whether a <strong>username is valid or invalid</strong> during login or other authentication-related functions (e.g., password reset). This allows attackers to enumerate valid usernames, which can then be targeted for brute-force or password-guessing attacks.</p>
</li>
<li>
<p><strong>Vulnerable Behavior Example:</strong></p>
<ul>
<li><strong>"Username not found."</strong> vs. <strong>"Incorrect password."</strong> messages for invalid vs. valid usernames.</li>
<li><strong>Different HTTP status codes</strong> (e.g., 200 OK vs. 403 Forbidden) or <strong>different response lengths/times</strong> for valid vs. invalid usernames.</li>
</ul>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is the <strong>application's failure to provide a generic, indistinguishable response for all failed login attempts</strong>, regardless of whether the username was valid or the password incorrect. This often stems from developers creating distinct code paths for different failure conditions, inadvertently leaking information.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Generic Error Message:</strong> Always return a <strong>single, generic error message</strong> for all failed login attempts (e.g., "Invalid username or password").</li>
<li><strong>Consistent Responses:</strong> Ensure that HTTP status codes, response lengths, and response times are <strong>consistent</strong> for all failed attempts to prevent inference.</li>
<li><strong>Account Lockout (Rate Limiting):</strong> Implement <strong>rate limiting and account lockout mechanisms</strong> to deter brute-force attacks on usernames, but be careful not to disclose lockout status for specific accounts.</li>
</ol>
</li>
<li>
<p><strong>Explanation of Fix:</strong> A <strong>generic error message</strong> eliminates the attacker's ability to differentiate between valid and invalid usernames based on the application's response, thus preventing enumeration. <strong>Consistent response behavior</strong> (status codes, lengths, times) reinforces this by removing other detectable "side channels" of information leakage.</p>
</li>
</ul>
<h4 id="weakpredictable-passwords-brute-forcible-login"><strong>Weak/Predictable Passwords &amp; Brute-Forcible Login</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong></p>
<ul>
<li><strong>Weak Passwords:</strong> Applications allowing users to set easily guessable passwords (e.g., dictionary words, short passwords, simple patterns, predictable initial passwords).</li>
<li><strong>Brute-Forcible Login:</strong> Applications failing to implement adequate controls (like rate limiting) to prevent an attacker from systematically guessing passwords through a large number of attempts.</li>
</ul>
</li>
<li>
<p><strong>Vulnerable Behavior Example:</strong></p>
<ul>
<li>An application allowing "password" as a password.</li>
<li>No lockout after 100 failed login attempts, allowing unlimited guessing.</li>
<li>Initial passwords generated sequentially, e.g., <code>user001</code>, <code>user002</code>.</li>
</ul>
</li>
<li>
<p><strong>Root Cause:</strong></p>
<ul>
<li><strong>Weak Password Policies:</strong> Lack of robust password complexity rules (length, character types).</li>
<li><strong>Insufficient Rate Limiting:</strong> Failure to implement mechanisms to detect and block or slow down repeated failed login attempts from a single source or against a single account.</li>
<li><strong>Predictable Generation:</strong> Use of weak or easily reversible algorithms for generating initial or temporary passwords.</li>
</ul>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Strong Password Policy:</strong> Enforce strong password complexity rules (minimum length, combination of character types) and prevent the use of common dictionary words.</li>
<li><strong>Rate Limiting/Account Lockout:</strong> Implement <strong>rate limiting on login attempts</strong> (e.g., delaying responses, CAPTCHAs after a few failures) and <strong>account lockout</strong> after a reasonable number of failed attempts. Be careful not to leak enumeration info, as noted above.</li>
<li><strong>Salted Hashing for Passwords:</strong> Store passwords using <strong>strong, salted, and adaptive hashing algorithms</strong> (e.g., bcrypt, Argon2). Never store cleartext passwords.</li>
<li><strong>Secure Password Generation:</strong> If generating passwords, use cryptographically secure random number generators to ensure unpredictability.</li>
<li><strong>Multi-factor Authentication (MFA):</strong> Implement MFA for critical accounts [206 (Implied)].</li>
</ol>
</li>
<li>
<p><strong>Explanation of Fix:</strong> <strong>Strong password policies</strong> make brute-force attacks computationally expensive and impractical. <strong>Rate limiting and account lockout</strong> directly mitigate brute-force attacks by slowing down or stopping an attacker's attempts. <strong>Salted hashing</strong> protects stored passwords even if the database is breached, making it impossible to reverse hashes to plaintext or use rainbow tables. <strong>Cryptographically secure generation</strong> ensures new passwords are unpredictable.</p>
</li>
</ul>
<h4 id="vulnerable-transmission-insecure-storage-of-credentials"><strong>Vulnerable Transmission &amp; Insecure Storage of Credentials</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong></p>
<ul>
<li><strong>Vulnerable Transmission:</strong> Credentials (usernames, passwords) are transmitted over unencrypted channels (HTTP instead of HTTPS) or are exposed in URLs or cookies.</li>
<li><strong>Insecure Storage:</strong> Passwords are stored in plaintext, easily reversible encryption, or unsalted/weakly hashed forms in the database or filesystem.</li>
</ul>
</li>
<li>
<p><strong>Vulnerable Behavior Example:</strong></p>
<ul>
<li><code>http://www.wahh-app.com/app?action=login&amp;uname=joe&amp;password=pass</code> â€“ Credentials in URL query string.</li>
<li>A database containing a "passwords" column with cleartext values.</li>
<li>Multiple user accounts sharing the same hash for a common password due to lack of salting.</li>
</ul>
</li>
<li>
<p><strong>Root Cause:</strong></p>
<ul>
<li><strong>Inadequate Use of HTTPS:</strong> Failure to use <strong>HTTPS for all authentication-related communication</strong>.</li>
<li><strong>Improper Credential Handling:</strong> Storing sensitive data in easily accessible locations (URLs, cookies) or <strong>using insecure storage methods</strong> for passwords (plaintext, weak hashing).</li>
<li><strong>Lack of Cryptographic Best Practices:</strong> Not applying standard, secure algorithms with strong key sizes for password hashing or data encryption.</li>
</ul>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Always Use HTTPS:</strong> All sensitive communication, especially authentication, <strong>must occur over HTTPS</strong>. Cookies carrying session tokens should be flagged as <code>Secure</code>.</li>
<li><strong>Never Store Passwords in Cleartext:</strong> Passwords should be <strong>hashed using cryptographically strong, salted, adaptive hashing algorithms</strong> (e.g., PBKDF2, bcrypt, scrypt, Argon2).</li>
<li><strong>Avoid Exposure in URLs/Cookies:</strong> Never transmit credentials in URL query strings or set them directly in insecure cookies.</li>
<li><strong>Review Cryptographic Implementations:</strong> Ensure standard, secure algorithms are used, and custom cryptographic implementations are avoided.</li>
</ol>
</li>
<li>
<p><strong>Corrected Code Example:</strong> (Illustrates secure hashing, no code for HTTPS itself)
    <div class="language-java highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c1">// Java example for secure password storage (representative)</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">hashPassword</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">salt</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="w">    </span><span class="c1">// Use a strong, adaptive hashing algorithm like BCrypt or Argon2 (external library needed)</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="w">    </span><span class="c1">// Example using a conceptual strongHash function:</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">strongHash</span><span class="p">(</span><span class="n">password</span><span class="p">,</span><span class="w"> </span><span class="n">salt</span><span class="p">);</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="p">}</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="c1">// ... when storing</span>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">salt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">generateRandomSalt</span><span class="p">();</span><span class="w"> </span><span class="c1">// Cryptographically secure random salt</span>
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="n">String</span><span class="w"> </span><span class="n">hashedPassword</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hashPassword</span><span class="p">(</span><span class="n">userPassword</span><span class="p">,</span><span class="w"> </span><span class="n">salt</span><span class="p">);</span>
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="c1">// Store hashedPassword and salt in the database</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Explanation of Fix:</strong> <strong>HTTPS encrypts data in transit</strong>, protecting credentials from eavesdropping. <strong>Salting</strong> adds randomness to password hashing, preventing rainbow table attacks and ensuring that identical passwords result in different hashes for different users. <strong>Adaptive hashing algorithms</strong> (like bcrypt) are computationally intensive, making brute-force attacks against stored hashes infeasible even with powerful hardware. Avoiding <strong>URLs/cookies for credentials</strong> prevents their exposure in logs or browser history.</p>
</li>
</ul>
<h4 id="incomplete-validation-of-credentials-logic-flaws-in-authentication"><strong>Incomplete Validation of Credentials / Logic Flaws in Authentication</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> These are subtle defects in the authentication process where the application's logic for validating credentials or managing authentication states is flawed. This can lead to bypasses, such as a partial password check or allowing login with only a username.</p>
</li>
<li>
<p><strong>Vulnerable Behavior Example:</strong>
    <div class="language-java highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="c1">// Java example of incomplete validation from Web Application Hacker&#39;s Handbook</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">checkCredentials</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">userExists</span><span class="p">(</span><span class="n">username</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w"> </span><span class="c1">// Check 1</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">passwordMatches</span><span class="p">(</span><span class="n">password</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w"> </span><span class="c1">// Check 2 (problematic)</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">password</span><span class="p">.</span><span class="na">length</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w"> </span><span class="c1">// Check 3</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="w">    </span><span class="c1">// If passwordMatches() is not called and the application relies on an exception</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="w">    </span><span class="c1">// that isn&#39;t always thrown or handled, a bypass might occur.</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="w">    </span><span class="c1">// ... more complex logic that can be bypassed</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="p">}</span>
</span></code></pre></div>
    An attacker might find ways to make <code>passwordMatches()</code> not return <code>false</code> (e.g., by causing an exception that is not caught, leading to a "fail-open" state).</p>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is <strong>flawed assumptions or incomplete logic in the authentication flow</strong>, especially in complex, multi-layered or multi-stage processes. Developers might overlook edge cases, error handling, or the sequence of validation checks, leading to "fail-open" conditions where the application grants access despite an invalid input.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Full Credential Validation:</strong> Passwords should be <strong>validated in full</strong>, case-sensitively, without filtering or modifying characters, and without truncating them.</li>
<li><strong>Aggressive Error Handling:</strong> Applications should be <strong>aggressive in defending against unexpected events</strong> during login processing. Use catch-all exception handlers around all API calls.</li>
<li><strong>Strict State Management:</strong> Ensure that the authentication state machine is strictly enforced, and unexpected state transitions are rejected.</li>
<li><strong>Explicit Failure:</strong> Design authentication logic to <strong>explicitly fail closed</strong> if any validation check or error condition is encountered that prevents full authentication.</li>
</ol>
</li>
<li>
<p><strong>Explanation of Fix:</strong> <strong>Full and consistent credential validation</strong> prevents attackers from guessing partial passwords or exploiting weaknesses in the validation logic. <strong>Aggressive error handling and explicit "fail closed" design</strong> ensure that any unexpected conditions or errors during the authentication process default to denying access, rather than inadvertently granting it.</p>
</li>
</ul>
<hr />
<h3 id="4-broken-session-management"><strong>4. Broken Session Management</strong></h3>
<p>Broken Session Management refers to vulnerabilities in how an application <strong>manages user sessions</strong>, including session ID generation, handling, and termination. Flaws can lead to session hijacking, session fixation, or unauthorized access.</p>
<h4 id="predictable-session-tokens"><strong>Predictable Session Tokens</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> Session tokens (or session IDs) are <strong>predictable</strong> if an attacker can guess or deduce valid tokens for other users. This predictability can arise from using weak random number generators, sequentially generated IDs, or embedding predictable/meaningful data within the token.</p>
</li>
<li>
<p><strong>Vulnerable Behavior Example:</strong></p>
<ul>
<li>Session IDs that are sequential numbers.</li>
<li>Session IDs that include easily discoverable information like a username, timestamp, or IP address in a plaintext or easily decodable format.</li>
<li>Using weak random number generators (<code>java.util.Random</code> instead of <code>SecureRandom</code>).</li>
</ul>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is the <strong>use of insecure or insufficient entropy sources for generating session IDs</strong>, leading to values that are guessable or can be reverse-engineered. Developers may also include meaningful but sensitive data directly in the token, which can be decoded.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Cryptographically Strong Session IDs:</strong> Generate session IDs using <strong>cryptographically strong random number generators</strong> (e.g., <code>java.security.SecureRandom</code>).</li>
<li><strong>Meaningless Content:</strong> Session ID content (or value) <strong>must be meaningless</strong> to prevent information disclosure attacks. Avoid embedding any user-specific or predictable data directly in the ID.</li>
<li><strong>Sufficient Length and Character Set:</strong> Ensure session IDs are of <strong>sufficient length</strong> and use a <strong>broad character set</strong> to increase entropy and make brute-forcing impractical.</li>
<li><strong>Regular Regeneration:</strong> Regenerate session IDs after <strong>successful authentication</strong> and <strong>privilege level changes</strong> to mitigate session fixation.</li>
</ol>
</li>
<li>
<p><strong>Corrected Code Example:</strong>
    <div class="language-java highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="c1">// Java example for generating a secure random number (from OWASP Guide)</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="kn">package</span><span class="w"> </span><span class="nn">org.owasp.java.crypto</span><span class="p">;</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.security.SecureRandom</span><span class="p">;</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.security.NoSuchAlgorithmException</span><span class="p">;</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="c1">// ...</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">RandomNumberGenerator</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="w">            </span><span class="n">SecureRandom</span><span class="w"> </span><span class="n">sr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SecureRandom</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="s">&quot;SHA1PRNG&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// Or another strong algorithm</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="w">            </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="p">;</span><span class="w"> </span><span class="c1">// Generate 16 bytes for a strong session ID</span>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="w">            </span><span class="n">sr</span><span class="p">.</span><span class="na">nextBytes</span><span class="p">(</span><span class="n">bytes</span><span class="p">);</span>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a><span class="w">            </span><span class="c1">// Convert bytes to a hex or Base64 string for the session ID</span>
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a><span class="w">            </span><span class="c1">// String sessionId = new BASE64Encoder().encode(bytes); // Example</span>
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a><span class="w">            </span><span class="c1">// ... then set the cookie</span>
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">NoSuchAlgorithmException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-16"><a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a><span class="w">            </span><span class="c1">// handle exception</span>
</span><span id="__span-24-17"><a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-24-18"><a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-24-19"><a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Explanation of Fix:</strong> <strong>Cryptographically strong random number generators</strong> produce high-entropy, unpredictable session IDs, making them practically impossible for an attacker to guess. Ensuring the <strong>ID is meaningless</strong> prevents information leakage if an attacker captures it. <strong>Regular regeneration</strong> of IDs (especially after login) prevents an attacker from using a known, unauthenticated session ID to hijack a legitimate, authenticated session (session fixation).</p>
</li>
</ul>
<h4 id="insecure-session-token-transmission-disclosure"><strong>Insecure Session Token Transmission &amp; Disclosure</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> Session tokens are transmitted insecurely (e.g., over HTTP) or are disclosed in vulnerable locations such as application logs, URLs, or error messages. This can allow attackers to steal session tokens and hijack user sessions.</p>
</li>
<li>
<p><strong>Vulnerable Behavior Example:</strong></p>
<ul>
<li>Session tokens transmitted in the URL query string (<code>http://example.com/page?sessionid=abc</code>).</li>
<li>Session tokens sent over plain HTTP instead of HTTPS.</li>
<li>Application logs (accessible by attackers or compromised parties) containing plaintext session IDs.</li>
</ul>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is the <strong>failure to enforce HTTPS for all sensitive communication</strong> and <strong>improper logging or handling of sensitive session information</strong>. Developers might mistakenly believe that only login pages need HTTPS, or they might log too much sensitive data.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Always Use HTTPS:</strong> Session tokens <strong>must only be transmitted over HTTPS</strong>.</li>
<li><strong>Secure Cookie Flag:</strong> HTTP cookies used for session tokens should be flagged as <code>Secure</code> to prevent browsers from sending them over unencrypted HTTP.</li>
<li><strong>HttpOnly Cookie Flag:</strong> Use the <code>HttpOnly</code> flag to prevent client-side scripts (like JavaScript) from accessing the session cookie, mitigating XSS-based session hijacking.</li>
<li><strong>Never Expose in URLs:</strong> Session IDs should <strong>never be passed in URLs</strong> (query strings or path parameters).</li>
<li><strong>Sensitive Data Logging:</strong> Avoid logging sensitive information like session tokens in application logs that could be accessed by unauthorized parties.</li>
</ol>
</li>
<li>
<p><strong>Explanation of Fix:</strong> <strong>HTTPS encryption</strong> protects the session token from eavesdropping during transit. The <strong><code>Secure</code> flag</strong> ensures the browser only sends the cookie over encrypted connections. The <strong><code>HttpOnly</code> flag</strong> prevents client-side script access, making XSS-based session hijacking more difficult. Avoiding <strong>URLs</strong> prevents tokens from being exposed in browser history, server logs, or referrer headers. <strong>Restricting logging of sensitive data</strong> prevents their disclosure if logs are compromised.</p>
</li>
</ul>
<h4 id="session-fixation"><strong>Session Fixation</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> Session fixation allows an attacker to "fix" a victim's session ID to a value known to the attacker. If the application does not issue a new session ID after successful authentication, the victim's authenticated session will use the attacker-supplied ID, allowing the attacker to hijack the session.</p>
</li>
<li>
<p><strong>Vulnerable Behavior Example:</strong></p>
<ol>
<li>Attacker visits an application, obtains a session ID (e.g., in a URL parameter).</li>
<li>Attacker sends this fixed session ID to the victim.</li>
<li>Victim logs in using the fixed session ID.</li>
<li>Application does not issue a new session ID after login.</li>
<li>Attacker uses the original, fixed session ID to access the victim's now-authenticated session.</li>
</ol>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is the <strong>application's failure to generate a new, cryptographically strong session ID upon successful user authentication</strong> or any change in privilege level.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Generate New Session ID on Login:</strong> Always <strong>invalidate the old session and generate a completely new session ID</strong> after a user successfully authenticates.</li>
<li><strong>Invalidate Session on Logout:</strong> Properly invalidate sessions upon logout.</li>
</ol>
</li>
<li>
<p><strong>Corrected Code Example:</strong>
    <div class="language-java highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="c1">// Java example to invalidate old session and create new one (from OWASP Guide)</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="n">request</span><span class="p">.</span><span class="na">getSession</span><span class="p">(</span><span class="kc">false</span><span class="p">).</span><span class="na">invalidate</span><span class="p">();</span><span class="w"> </span><span class="c1">// Invalidate existing session</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="c1">// Then create a new session</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="n">request</span><span class="p">.</span><span class="na">getSession</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="w"> </span><span class="c1">// getSession() also creates new if none exists</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Explanation of Fix:</strong> By <strong>invalidating the pre-authentication session ID and issuing a new one upon successful login</strong>, the application ensures that the attacker's "fixed" session ID becomes invalid, and the attacker can no longer use it to access the victim's authenticated session.</p>
</li>
</ul>
<hr />
<h3 id="5-access-control-vulnerabilities-missing-function-level-access-control"><strong>5. Access Control Vulnerabilities (Missing Function Level Access Control)</strong></h3>
<p>Access control vulnerabilities occur when an application fails to <strong>properly enforce restrictions on what authenticated users can do or access</strong>. This can lead to horizontal privilege escalation (accessing other users' data at the same privilege level) or vertical privilege escalation (accessing functions or data reserved for higher-privileged users).</p>
<h4 id="unprotected-functionality-vertical-privilege-escalation"><strong>Unprotected Functionality (Vertical Privilege Escalation)</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> This vulnerability allows a lower-privileged user to <strong>access functionality or pages intended for higher-privileged users</strong> (e.g., administrative functions) by directly navigating to the URL or manipulating parameters, without proper server-side authorization checks.</p>
</li>
<li>
<p><strong>Vulnerable Behavior Example:</strong></p>
<ul>
<li>An administrative page (e.g., <code>/admin/users.jsp</code>) that can be accessed by a regular user simply by typing the URL, even if there's no link to it in their UI.</li>
<li>Client-side JavaScript or HTML comments containing references to hidden administrative URLs or API methods.</li>
</ul>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is the <strong>reliance on client-side controls (e.g., hiding links, disabling buttons) for enforcing access control</strong>, or the <strong>absence of robust server-side authorization checks for every request to sensitive functionality</strong>. Developers might assume that if a function is not linked, it cannot be accessed.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Server-Side Enforcement:</strong> <strong>All access control decisions must be enforced on the server-side</strong>. Client-side controls should only be used for UI/UX, not security.</li>
<li><strong>Per-Function Authorization:</strong> Implement <strong>explicit authorization checks for every sensitive function or resource</strong>, verifying the user's role and permissions before executing the action or returning data.</li>
<li><strong>Role-Based Access Control (RBAC):</strong> Use a robust RBAC model, where access is granted based on assigned roles, and these checks are performed at every access point.</li>
<li><strong>Least Privilege:</strong> Applications should always apply the <strong>principle of least privilege</strong>, granting users only the minimum necessary permissions for their tasks.</li>
</ol>
</li>
<li>
<p><strong>Corrected Code Example:</strong>
    (Representative example, demonstrating server-side check)
    <div class="language-java highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="c1">// Java example for server-side authorization check (representative)</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">adminPage</span><span class="p">(</span><span class="n">HttpServletRequest</span><span class="w"> </span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">HttpServletResponse</span><span class="w"> </span><span class="n">response</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">request</span><span class="p">.</span><span class="na">getSession</span><span class="p">().</span><span class="na">getAttribute</span><span class="p">(</span><span class="s">&quot;userRole&quot;</span><span class="p">).</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;admin&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// Server-side role check</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="w">        </span><span class="n">response</span><span class="p">.</span><span class="na">sendError</span><span class="p">(</span><span class="n">HttpServletResponse</span><span class="p">.</span><span class="na">SC_FORBIDDEN</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Access Denied&quot;</span><span class="p">);</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="w">        </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="w">    </span><span class="c1">// Proceed with administrative functionality</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Explanation of Fix:</strong> <strong>Enforcing access control on the server-side</strong> means that even if an attacker bypasses client-side restrictions or guesses URLs, the server will independently verify their authorization, denying access if privileges are insufficient. <strong>Per-function authorization</strong> ensures that no sensitive action is left unprotected, preventing unauthorized users from invoking them.</p>
</li>
</ul>
<h4 id="insecure-direct-object-reference-horizontal-privilege-escalation"><strong>Insecure Direct Object Reference (Horizontal Privilege Escalation)</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> Insecure Direct Object Reference (IDOR) vulnerabilities occur when an application exposes a direct reference to an internal implementation object (like a file, database key, or directory) and allows a user to <strong>manipulate this reference to access resources they are not authorized to view or modify</strong>, typically belonging to another user at the same privilege level.</p>
</li>
<li>
<p><strong>Vulnerable Behavior Example:</strong>
    <div class="language-java highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="c1">// Java example from OWASP Guide</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="n">String</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SELECT * FROM accts WHERE account = ?&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Uses parameter for account number</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="n">PreparedStatement</span><span class="w"> </span><span class="n">pstmt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">connection</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="n">query</span><span class="p">,</span><span class="w"> </span><span class="p">...);</span>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="n">pstmt</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getParameter</span><span class="p">(</span><span class="s">&quot;acct&quot;</span><span class="p">));</span><span class="w"> </span><span class="c1">// Untrusted &#39;acct&#39; parameter</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="n">ResultSet</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pstmt</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">();</span>
</span></code></pre></div>
    An attacker might change the <code>acct</code> parameter in the URL (e.g., <code>viewinvoice.jsp?acct=12345</code>) to <code>viewinvoice.jsp?acct=67890</code> to access another user's account without proper authorization checks.</p>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is the application's <strong>failure to implement proper authorization checks</strong> to verify if the user requesting a resource is indeed authorized to access <em>that specific resource</em>, especially when the resource is identified by user-controlled input. The application assumes that direct object references provided by the user are always legitimate.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Per-Resource Authorization:</strong> For every request involving a direct object reference, the application <strong>must perform an authorization check to confirm the user is authorized for that specific object</strong>.</li>
<li><strong>Indirect Object References:</strong> Use <strong>indirect object references</strong> (e.g., a per-session, per-user, or randomly generated index) instead of direct database keys or file names in URLs or parameters. Map these indirect references to the actual objects on the server-side.</li>
<li><strong>Input Validation:</strong> Ensure any untrusted input used to reference objects is properly understood and used by the server-side code, although authorization is the primary defense.</li>
</ol>
</li>
<li>
<p><strong>Explanation of Fix:</strong> <strong>Per-resource authorization checks</strong> ensure that even if an attacker guesses valid object IDs, they will only be granted access if their authenticated session is explicitly linked to that resource. <strong>Indirect object references</strong> make it harder for attackers to guess valid resource identifiers, adding an additional layer of security, though the server-side authorization check remains the critical control.</p>
</li>
</ul>
<hr />
<h3 id="6-security-misconfiguration"><strong>6. Security Misconfiguration</strong></h3>
<p>Security Misconfiguration refers to vulnerabilities arising from <strong>improperly configured security settings</strong> across the application stack, including web servers, application servers, databases, frameworks, and custom code.</p>
<ul>
<li>
<p><strong>Description / Definition:</strong> This category includes vulnerabilities due to:</p>
<ul>
<li><strong>Default accounts or credentials</strong> that are left unchanged.</li>
<li><strong>Default or unnecessary content</strong> (e.g., sample applications, development files) exposed in production environments.</li>
<li><strong>Improper permissions</strong> on files and directories.</li>
<li><strong>Missing security hardening</strong> (e.g., disabling unneeded services, insecure error handling).</li>
</ul>
</li>
<li>
<p><strong>Vulnerable Behavior Example:</strong></p>
<ul>
<li>A production server with default admin username/password (e.g., <code>admin/admin</code>).</li>
<li>Default sample applications like Apache Tomcat's "Sessions Example" script that exposes session variables.</li>
<li>Directory listings enabled on web servers, allowing attackers to browse file structures.</li>
<li>Insecure error handling disclosing sensitive debug information.</li>
</ul>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is often a <strong>lack of awareness or oversight during deployment</strong>, where default, insecure settings are not changed, or unnecessary components are left exposed. It can also stem from complex frameworks with many configurable options, making it difficult to secure everything correctly.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Secure Installation and Hardening:</strong> Follow <strong>secure installation guides and hardening checklists</strong> for all components (OS, web server, application server, database, frameworks).</li>
<li><strong>Change Defaults:</strong> <strong>Change all default credentials and remove any default accounts</strong> not strictly required.</li>
<li><strong>Remove Unnecessary Features/Content:</strong> <strong>Remove or disable all unused features, components, services, and default content</strong> (e.g., sample applications, old files, debug functionality) from production servers.</li>
<li><strong>Principle of Least Privilege:</strong> Configure all accounts, processes, and file/directory permissions with the <strong>minimum necessary privileges</strong>.</li>
<li><strong>Secure Error Handling:</strong> Implement <strong>generic error pages</strong> and ensure verbose error messages or stack traces are not displayed to users. Logs containing sensitive information should be stored server-side and secured.</li>
<li><strong>Automated Security Scans:</strong> Regularly run <strong>automated security misconfiguration scans</strong> to identify deviations from secure baselines.</li>
</ol>
</li>
<li>
<p><strong>Explanation of Fix:</strong> <strong>Hardening and removing defaults</strong> eliminate easy entry points for attackers who rely on common configurations. <strong>Least privilege</strong> minimizes the impact if a component is compromised. <strong>Secure error handling</strong> prevents information leakage that attackers can use to fine-tune attacks. These measures create a more robust and smaller attack surface for the application.</p>
</li>
</ul>
<hr />
<h3 id="7-sensitive-data-exposure-cryptographic-flaws"><strong>7. Sensitive Data Exposure (Cryptographic Flaws)</strong></h3>
<p>Sensitive Data Exposure occurs when applications <strong>fail to adequately protect sensitive data</strong> (e.g., financial information, PII, passwords) both at rest and in transit. This often stems from <strong>improper implementation of cryptographic controls</strong>.</p>
<ul>
<li>
<p><strong>Description / Definition:</strong> Vulnerabilities include:</p>
<ul>
<li><strong>Use of non-standard cryptographic algorithms</strong> or custom implementations.</li>
<li><strong>Use of cryptographically insecure standard algorithms</strong> (e.g., DES, MD5 for passwords without salting).</li>
<li><strong>Insecure key management</strong> (e.g., hardcoding keys, weak key sizes, improper key storage).</li>
<li><strong>Lack of encryption</strong> for sensitive data in storage or transit.</li>
</ul>
</li>
<li>
<p><strong>Vulnerable Behavior Example:</strong></p>
<ul>
<li>A custom hashing algorithm implemented by a developer instead of well-vetted library functions.</li>
<li>Storing passwords using MD5 without a unique salt per password.</li>
<li>Hardcoding encryption keys within the application source code.</li>
</ul>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is typically a <strong>lack of cryptographic expertise among developers</strong>, leading them to implement weak or incorrect cryptographic practices, or choose outdated/insecure algorithms. Developers may "roll their own" crypto instead of using well-vetted, standard libraries.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Use Standard, Strong Algorithms:</strong> Always use <strong>standard, cryptographically strong algorithms</strong> (e.g., AES for encryption, SHA-256/SHA-512 for hashing with proper salting, modern KDFs like PBKDF2, bcrypt, scrypt, Argon2 for password storage).</li>
<li><strong>Never "Roll Your Own Crypto":</strong> <strong>Never implement custom cryptographic algorithms</strong>; instead, use functions provided by the language, framework, or common (trusted) cryptographic libraries.</li>
<li><strong>Secure Key Management:</strong> Implement secure practices for <strong>generating, storing, and managing cryptographic keys</strong>. Avoid hardcoding keys.</li>
<li><strong>Encrypt Data at Rest and in Transit:</strong> Ensure sensitive data is encrypted both when stored (at rest) and when transmitted (in transit) using strong encryption protocols like TLS.</li>
<li><strong>Regularly Update Crypto Libraries:</strong> Keep cryptographic libraries and implementations up-to-date to benefit from security patches and new best practices.</li>
</ol>
</li>
<li>
<p><strong>Corrected Code Example:</strong> (Illustrates concept of using a trusted library for hashing)
    <div class="language-java highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="c1">// Java example for secure hashing using a standard library (conceptual, specific library not in source)</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="c1">// Avoids custom hash functions or simple MD5/SHA-1 without salting.</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">hashPasswordSecurely</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">NoSuchAlgorithmException</span><span class="p">,</span><span class="w"> </span><span class="n">InvalidKeySpecException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="w">    </span><span class="c1">// Example: Using PBKDF2 (requires proper salt generation and iteration count)</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="w">    </span><span class="n">SecureRandom</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SecureRandom</span><span class="p">();</span>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="w">    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">salt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="p">;</span>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="w">    </span><span class="n">random</span><span class="p">.</span><span class="na">nextBytes</span><span class="p">(</span><span class="n">salt</span><span class="p">);</span>
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a>
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a><span class="w">    </span><span class="n">PBEKeySpec</span><span class="w"> </span><span class="n">spec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PBEKeySpec</span><span class="p">(</span><span class="n">password</span><span class="p">.</span><span class="na">toCharArray</span><span class="p">(),</span><span class="w"> </span><span class="n">salt</span><span class="p">,</span><span class="w"> </span><span class="mi">65536</span><span class="p">,</span><span class="w"> </span><span class="mi">256</span><span class="p">);</span><span class="w"> </span><span class="c1">// High iteration count, key length</span>
</span><span id="__span-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a><span class="w">    </span><span class="n">SecretKeyFactory</span><span class="w"> </span><span class="n">factory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SecretKeyFactory</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="s">&quot;PBKDF2WithHmacSHA256&quot;</span><span class="p">);</span>
</span><span id="__span-28-11"><a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a><span class="w">    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factory</span><span class="p">.</span><span class="na">generateSecret</span><span class="p">(</span><span class="n">spec</span><span class="p">).</span><span class="na">getEncoded</span><span class="p">();</span>
</span><span id="__span-28-12"><a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a>
</span><span id="__span-28-13"><a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a><span class="w">    </span><span class="c1">// Store salt and hash securely</span>
</span><span id="__span-28-14"><a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Base64</span><span class="p">.</span><span class="na">getEncoder</span><span class="p">().</span><span class="na">encodeToString</span><span class="p">(</span><span class="n">salt</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;:&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Base64</span><span class="p">.</span><span class="na">getEncoder</span><span class="p">().</span><span class="na">encodeToString</span><span class="p">(</span><span class="n">hash</span><span class="p">);</span>
</span><span id="__span-28-15"><a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Explanation of Fix:</strong> Relying on <strong>standard, well-vetted cryptographic libraries</strong> ensures that the algorithms and their implementations have been rigorously tested and are resistant to known attacks. <strong>Secure key management</strong> prevents attackers from accessing the "keys to the kingdom" even if they gain some level of system access. <strong>Proper hashing with salts and adaptive functions</strong> for passwords and encryption for other sensitive data protects against brute-force, rainbow table, and decryption attacks.</p>
</li>
</ul>
<hr />
<h3 id="8-cross-site-request-forgery-csrf"><strong>8. Cross-Site Request Forgery (CSRF)</strong></h3>
<ul>
<li>
<p><strong>Description / Definition:</strong> Cross-Site Request Forgery (CSRF) is an attack that forces an authenticated end-user to <strong>submit an unwanted request</strong> to a web application they are currently authenticated to. Unlike XSS, CSRF attacks target the application's functionality, not its users directly, by leveraging the trust the application has in the user's browser.</p>
</li>
<li>
<p><strong>Vulnerable Behavior Example:</strong> (Representative, based on's explanation)
    A banking application allows a user to transfer funds via a POST request that looks like:
    <code>POST /transfer HTTP/1.1</code>
    <code>Cookie: sessionid=abc...</code>
    <code>amount=1000&amp;account=attacker_account</code></p>
<p>If this request doesn't include any unpredictable tokens, an attacker can create a malicious HTML page:
<div class="language-html highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="cm">&lt;!-- Malicious HTML page --&gt;</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;http://bank.com/transfer&quot;</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;POST&quot;</span><span class="p">&gt;</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;amount&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;1000&quot;</span><span class="p">&gt;</span>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;account&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;attacker_account&quot;</span><span class="p">&gt;</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;Click me!&quot;</span><span class="p">&gt;</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a><span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">forms</span><span class="p">.</span><span class="nx">submit</span><span class="p">();</span><span class="w"> </span><span class="c1">// Auto-submits the form</span>
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></code></pre></div>
If a logged-in user visits this page, the form is submitted to <code>bank.com</code> with the user's session cookie, performing the transfer.</p>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is that the application <strong>relies solely on session cookies for tracking user sessions</strong> and <strong>does not include any unique, unpredictable, and user-specific token in sensitive requests</strong> to verify that the request originated from the legitimate user's browser. Browsers automatically include session cookies with cross-site requests, which the application implicitly trusts.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Anti-CSRF Tokens (Synchronizer Token Pattern):</strong> The primary defense is to include a <strong>unique, unpredictable, and cryptographically strong anti-CSRF token</strong> in every state-changing request. This token should be generated server-side, associated with the user's session, and validated on the server. It should be placed in hidden form fields or custom HTTP headers, not in cookies.</li>
<li><strong>SameSite Cookie Attribute:</strong> Use the <code>SameSite</code> cookie attribute (<code>Lax</code> or <code>Strict</code>) to instruct browsers to restrict sending cookies with cross-site requests. (This is not explicitly in the sources but is a modern related best practice.)</li>
<li><strong>Referrer Header Validation:</strong> While not a standalone defense, checking the <code>Referer</code> header can offer some protection, but it can be bypassed.</li>
<li><strong>Re-authentication:</strong> For highly sensitive actions, requiring the user to re-authenticate can mitigate CSRF.</li>
</ol>
</li>
<li>
<p><strong>Corrected Code Example:</strong> (Representative)
    <div class="language-html highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="cm">&lt;!-- HTML form with anti-CSRF token --&gt;</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;/transfer&quot;</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;POST&quot;</span><span class="p">&gt;</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;amount&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;1000&quot;</span><span class="p">&gt;</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;account&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;attacker_account&quot;</span><span class="p">&gt;</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;csrf_token&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;GENERATED_SERVER_SIDE_TOKEN&quot;</span><span class="p">&gt;</span> <span class="cm">&lt;!-- Anti-CSRF token --&gt;</span>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;Transfer Funds&quot;</span><span class="p">&gt;</span>
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span></code></pre></div>
    On the server, before processing the transfer:
    <div class="language-java highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="c1">// Java example for server-side CSRF token validation (representative)</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="n">String</span><span class="w"> </span><span class="n">submittedToken</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getParameter</span><span class="p">(</span><span class="s">&quot;csrf_token&quot;</span><span class="p">);</span>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="n">String</span><span class="w"> </span><span class="n">sessionToken</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getSession</span><span class="p">().</span><span class="na">getAttribute</span><span class="p">(</span><span class="s">&quot;csrf_token&quot;</span><span class="p">);</span>
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a>
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">submittedToken</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="n">submittedToken</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">sessionToken</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a><span class="w">    </span><span class="n">response</span><span class="p">.</span><span class="na">sendError</span><span class="p">(</span><span class="n">HttpServletResponse</span><span class="p">.</span><span class="na">SC_FORBIDDEN</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Invalid CSRF token&quot;</span><span class="p">);</span>
</span><span id="__span-31-7"><a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a><span class="w">    </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-31-8"><a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a><span class="p">}</span>
</span><span id="__span-31-9"><a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a><span class="c1">// Proceed with funds transfer</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Explanation of Fix:</strong> An <strong>anti-CSRF token</strong> acts as a secret shared only between the legitimate user's browser and the server for a specific request. When a malicious request is forged, the attacker cannot obtain this secret token (due to the same-origin policy), so the forged request will lack the valid token, and the server will reject it. This breaks the trust relationship that CSRF attacks exploit.</p>
</li>
</ul>
<hr />
<h3 id="9-unvalidated-redirects-and-forwards"><strong>9. Unvalidated Redirects and Forwards</strong></h3>
<ul>
<li>
<p><strong>Description / Definition:</strong> Unvalidated Redirects and Forwards allow an attacker to <strong>redirect or forward a user to an arbitrary, untrusted URL</strong> based on unvalidated user input. This can be used for phishing attacks, malware distribution, or to bypass access controls for internal forwards.</p>
</li>
<li>
<p><strong>Vulnerable Code Example:</strong>
    <div class="language-java highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="c1">// Java example from OWASP Guide</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="n">String</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getParameter</span><span class="p">(</span><span class="s">&quot;url&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// User-controlled &#39;url&#39; parameter</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="n">response</span><span class="p">.</span><span class="na">sendRedirect</span><span class="p">(</span><span class="n">url</span><span class="p">);</span><span class="w"> </span><span class="c1">// Vulnerable, redirects to arbitrary URL</span>
</span></code></pre></div>
    An attacker could submit <code>?url=http://malicious.com</code> to redirect the victim.</p>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is the <strong>application's failure to validate user-supplied input used to determine redirect or forward destinations</strong>. The application implicitly trusts that the provided URL or path is safe.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Whitelist Destinations:</strong> All redirects/forwards must be constructed based on a <strong>whitelist of known, safe destinations</strong>.</li>
<li><strong>Relative Paths:</strong> Use <strong>relative paths</strong> for redirects whenever possible to ensure the user stays on the trusted site.</li>
<li><strong>Strict Input Validation:</strong> If external redirects are necessary, strictly validate the user-supplied URL to ensure it matches allowed patterns and does not contain malicious schemes or hosts.</li>
</ol>
</li>
<li>
<p><strong>Corrected Code Example:</strong>
    <div class="language-java highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="c1">// Java example with whitelist validation (representative)</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="n">String</span><span class="w"> </span><span class="n">urlParam</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getParameter</span><span class="p">(</span><span class="s">&quot;url&quot;</span><span class="p">);</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">allowedUrls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="s">&quot;/home&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/profile&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/logout&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// Whitelist of relative paths</span>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">allowedUrls</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">urlParam</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a><span class="w">    </span><span class="n">response</span><span class="p">.</span><span class="na">sendRedirect</span><span class="p">(</span><span class="n">urlParam</span><span class="p">);</span><span class="w"> </span><span class="c1">// Safe redirect to known internal path</span>
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a><span class="w">    </span><span class="n">response</span><span class="p">.</span><span class="na">sendRedirect</span><span class="p">(</span><span class="s">&quot;/error&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// Redirect to a safe default page</span>
</span><span id="__span-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Explanation of Fix:</strong> A <strong>whitelist</strong> ensures that the application will only redirect or forward to predefined, trusted locations, preventing an attacker from arbitrarily sending users to malicious sites. <strong>Using relative paths</strong> further constrains redirects to within the current application, reducing the scope of potential attacks.</p>
</li>
</ul>
<hr />
<h3 id="10-application-logic-flaws"><strong>10. Application Logic Flaws</strong></h3>
<p>Application logic flaws (also known as business logic flaws) are defects in an application's design or implementation that allow an attacker to <strong>subvert the intended workflow or rules of the application</strong> to achieve unauthorized outcomes. These are highly varied and often unique to each application's specific functionality.</p>
<ul>
<li>
<p><strong>Description / Definition:</strong> Logic flaws can manifest in many ways, including:</p>
<ul>
<li><strong>Bypassing multi-stage processes</strong> by skipping steps or submitting requests out of sequence.</li>
<li><strong>Invalidating input validation</strong> by exploiting the order or recursion of validation steps (e.g., truncation after sanitization).</li>
<li><strong>Abusing search functions</strong> to infer sensitive data not directly accessible.</li>
<li><strong>Exploiting race conditions</strong> where concurrent requests can lead to unintended states.</li>
<li><strong>Trust boundary violations</strong> where components implicitly trust data from other, less-secured components.</li>
</ul>
</li>
<li>
<p><strong>Vulnerable Behavior Example:</strong></p>
<ul>
<li><strong>Bypassing multi-stage process:</strong> A "password change" function that requires current password, new password, and confirmation, but can be bypassed by omitting the "current password" parameter.</li>
<li><strong>Invalidating input validation:</strong> An application filters single quotes then truncates input. An attacker submits <code>admin'--</code> which becomes <code>admin''--</code>. If the filter is applied, but then truncation cuts off some of the escaping, it might become <code>admin'</code> again, leading to SQL Injection.</li>
<li><strong>Abusing Search:</strong> A search function for "public documents" also indexes "private documents". Searching for parts of private documents reveals their existence or content through hits, even if the user can't view them directly.</li>
</ul>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is typically <strong>flawed assumptions made by designers or developers</strong> about user behavior, data integrity, or the interaction between different application components. They fail to consider how an attacker might intentionally violate these assumptions. Complex applications with multiple developers and layered logic are particularly susceptible.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Thorough Design Documentation:</strong> Document every aspect of the application's design, including all assumptions made by developers and designers.</li>
<li><strong>Clear Code Comments:</strong> Comment source code to explain the purpose of components, their assumptions, and client code dependencies.</li>
<li><strong>Strict State Management:</strong> For multi-stage processes, strictly enforce the expected sequence of steps and reject out-of-sequence requests. Use server-side state machines.</li>
<li><strong>Validate All Input:</strong> Understand how input validation interacts with other data transformations (truncation, encoding) and ensure robust validation at all layers, not just at the entry point.</li>
<li><strong>Test Trust Boundaries:</strong> Explicitly define and test trust boundaries between application components. Treat data from adjacent components with the same skepticism as external user input.</li>
<li><strong>Review Search Indexing:</strong> Ensure search functions only index data appropriate for the user's privilege level, and that results do not allow inference of unauthorized data.</li>
<li><strong>Systematic Logic Testing:</strong> Conduct systematic probing and lateral thinking to test the application's behavior in response to unexpected input or sequence changes.</li>
</ol>
</li>
<li>
<p><strong>Explanation of Fix:</strong> <strong>Thorough documentation and clear code comments</strong> help prevent flawed assumptions from being introduced or remaining undetected. <strong>Strict server-side state management</strong> ensures that business processes are followed correctly, preventing attackers from skipping steps or manipulating workflows. <strong>Robust input validation at all stages</strong> and <strong>explicit trust boundary definitions</strong> mitigate issues arising from data transformations or inter-component communication. Ultimately, <strong>imaginative and systematic testing</strong> is key to uncovering these subtle flaws.</p>
</li>
</ul>
<hr />
<h3 id="11-native-code-vulnerabilities"><strong>11. Native Code Vulnerabilities</strong></h3>
<p>These vulnerabilities specifically affect applications written in <strong>native code languages like C and C++</strong>, which do not run in managed execution environments (like Java or .NET). They are low-level memory safety issues that can be exploited for arbitrary code execution or denial of service.</p>
<h4 id="buffer-overflows"><strong>Buffer Overflows</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> Buffer overflows occur when a program attempts to write more data into a fixed-size memory buffer than it can hold, overwriting adjacent memory locations. This can lead to crashes (denial of service), corruption of data, or, in severe cases, arbitrary code execution by overwriting return addresses or other critical program data.</p>
</li>
<li>
<p><strong>Vulnerable Code Example:</strong> (Representative, based on's general description)
    <div class="language-c highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="c1">// C example (representative)</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="kt">char</span><span class="w"> </span><span class="n">buffer</span><span class="p">;</span><span class="w"> </span><span class="c1">// Fixed-size buffer</span>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="n">strcpy</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="n">userinput</span><span class="p">);</span><span class="w"> </span><span class="c1">// Vulnerable if userinput &gt; 199 characters (plus null terminator)</span>
</span></code></pre></div>
    If <code>userinput</code> is larger than 199 characters, <code>strcpy</code> will write beyond <code>buffer</code>'s boundary.</p>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is the <strong>use of unsafe C/C++ string or memory manipulation functions</strong> (e.g., <code>strcpy</code>, <code>strcat</code>, <code>memcpy</code>, <code>sprintf</code>) that do not perform bounds checking and do not explicitly ensure the destination buffer is large enough for the source data.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Use Bounds-Checking Functions:</strong> Always use <strong>safe, bounds-checking versions of string/memory functions</strong> (e.g., <code>strncpy</code>, <code>strncat</code>, <code>memcpy_s</code>, <code>snprintf</code>) or higher-level abstractions that manage memory safely.</li>
<li><strong>Input Length Validation:</strong> Validate the length of user input <strong>before</strong> copying it into fixed-size buffers.</li>
<li><strong>Managed Memory Environments:</strong> Where possible, develop in languages that use managed memory environments (e.g., Java, C#, Python) where buffer overflows are significantly less common.</li>
<li><strong>Compiler Protections:</strong> Enable compiler-level protections (e.g., Stack Smashing Protectors like <code>/GS</code> in Visual C++, <code>-fstack-protector</code> in GCC/Clang) [636 (implied)].</li>
</ol>
</li>
<li>
<p><strong>Corrected Code Example:</strong> (Representative)
    <div class="language-c highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="c1">// C example with bounds-checking (representative)</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="kt">char</span><span class="w"> </span><span class="n">buffer</span><span class="p">;</span>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="c1">// Ensure userinput_len is properly calculated and does not exceed buffer size</span>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="n">strncpy</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="n">userinput</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c1">// Copies at most size-1 characters</span>
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a><span class="n">buffer</span><span class="p">[</span><span class="k">sizeof</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Ensure null termination</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Explanation of Fix:</strong> <strong>Bounds-checking functions</strong> explicitly prevent writing beyond the allocated buffer size, truncating input if necessary, thereby eliminating the overflow condition. <strong>Input validation</strong> ensures that malicious overlong input is detected and rejected early. Using <strong>managed languages</strong> offloads memory management to a runtime, eliminating common low-level memory errors.</p>
</li>
</ul>
<h4 id="integer-vulnerabilities"><strong>Integer Vulnerabilities</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> Integer vulnerabilities arise from <strong>improper handling of integer values</strong> within calculations or comparisons, leading to issues like:</p>
<ul>
<li><strong>Integer Overflow/Underflow:</strong> When an arithmetic operation produces a value that is too large (overflow) or too small (underflow) to be stored in the intended integer type, causing it to "wrap around".</li>
<li><strong>Signedness Errors:</strong> Mismatching signed and unsigned integer types in operations or comparisons, leading to unexpected behavior.</li>
</ul>
</li>
<li>
<p><strong>Vulnerable Behavior Example:</strong> (Representative, based on's explanation)
    <div class="language-c highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="c1">// C example (representative)</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="kt">int</span><span class="w"> </span><span class="n">numItems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="n">getParameter</span><span class="p">(</span><span class="s">&quot;items&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// User supplies a large number like 2,000,000,000</span>
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="kt">int</span><span class="w"> </span><span class="n">pricePerItem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a><span class="kt">int</span><span class="w"> </span><span class="n">totalCost</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numItems</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pricePerItem</span><span class="p">;</span><span class="w"> </span><span class="c1">// Integer overflow if totalCost exceeds max int value</span>
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="c1">// totalCost might wrap around to a negative number, leading to discount or free items</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is <strong>insufficient validation of integer inputs and outputs</strong>, combined with a lack of awareness of how integer types behave at their boundaries and when different types (signed/unsigned) interact.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Input Range Validation:</strong> Validate that user-supplied numerical inputs are <strong>within expected safe ranges</strong> to prevent overflow/underflow before performing calculations.</li>
<li><strong>Use Larger Data Types:</strong> Use integer data types that are sufficiently large to hold expected values, or use fixed-precision arithmetic for financial calculations.</li>
<li><strong>Careful Signed/Unsigned Comparisons:</strong> Be cautious when mixing signed and unsigned integer types in comparisons or arithmetic operations.</li>
<li><strong>Error Handling for Arithmetic Operations:</strong> Explicitly check for overflow/underflow conditions after sensitive arithmetic operations.</li>
</ol>
</li>
<li>
<p><strong>Explanation of Fix:</strong> <strong>Input range validation</strong> prevents attackers from supplying values that would cause integer overflows or underflows. Using <strong>appropriately sized data types</strong> and <strong>explicit checks</strong> ensures that calculations do not produce unintended results due to integer wrapping.</p>
</li>
</ul>
<h4 id="format-string-bugs"><strong>Format String Bugs</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> Format string bugs occur when an application processes user-supplied input as a format string in functions like <code>printf</code> or <code>sprintf</code>. This can allow an attacker to read or write arbitrary memory locations, or even execute arbitrary code, by supplying specially crafted format specifiers (e.g., <code>%x</code>, <code>%n</code>, <code>%s</code>).</p>
</li>
<li>
<p><strong>Vulnerable Code Example:</strong> (Representative, based on's explanation)
    <div class="language-c highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="c1">// C example (representative)</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="kt">char</span><span class="w"> </span><span class="n">buffer</span><span class="p">;</span>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="n">sprintf</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="n">getParameter</span><span class="p">(</span><span class="s">&quot;input&quot;</span><span class="p">));</span><span class="w"> </span><span class="c1">// Vulnerable: input is directly used as format string</span>
</span></code></pre></div>
    If <code>request.getParameter("input")</code> is <code>"%x%x%x%x"</code>, it will print stack contents. If it contains <code>%n</code>, it can write to memory.</p>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is passing <strong>unvalidated user input directly as the <code>format</code> argument to format string functions</strong>. These functions interpret the input as instructions for how to parse and print subsequent arguments, which an attacker can manipulate to access memory or crash the application.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Never Use User Input as Format String:</strong> The most effective defense is to <strong>never pass user-supplied input as the format argument</strong> to <code>printf</code>-style functions.</li>
<li><strong>Use Fixed Format String:</strong> Always use a fixed, constant format string, and pass user input as separate arguments (e.g., <code>printf("%s", user_input);</code>).</li>
<li><strong>Input Validation:</strong> Validate and sanitize any user input that might be processed by format string functions to ensure it does not contain format specifiers.</li>
</ol>
</li>
<li>
<p><strong>Corrected Code Example:</strong> (Representative)
    <div class="language-c highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="c1">// C example with fixed format string (representative)</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="kt">char</span><span class="w"> </span><span class="n">buffer</span><span class="p">;</span>
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="n">sprintf</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="n">getParameter</span><span class="p">(</span><span class="s">&quot;input&quot;</span><span class="p">));</span><span class="w"> </span><span class="c1">// Secure: user input is treated as a string argument</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Explanation of Fix:</strong> By using a <strong>fixed format string</strong> (<code>%s</code>) and passing the user input as a separate argument, the format string function is prevented from interpreting the user's input as its own formatting instructions. Instead, it treats the entire user input as a single string to be printed, effectively neutralizing any malicious format specifiers.</p>
</li>
</ul>
<hr />
<h3 id="12-information-disclosure"><strong>12. Information Disclosure</strong></h3>
<p>Information Disclosure vulnerabilities occur when an application <strong>unintentionally reveals sensitive information</strong> to an attacker that could be used to compromise the application or its underlying systems.</p>
<ul>
<li>
<p><strong>Description / Definition:</strong> This includes:</p>
<ul>
<li><strong>Verbose Error Messages:</strong> Revealing stack traces, database error messages, internal paths, or debugging information.</li>
<li><strong>Source Code Comments:</strong> Containing sensitive details like usernames, passwords, "TODO" items for security fixes, or internal logic.</li>
<li><strong>Directory Listings:</strong> Allowing directory browsing on web servers.</li>
<li><strong>Insecure Logging:</strong> Logging sensitive data (passwords, session IDs, PII) in plaintext logs accessible to attackers.</li>
<li><strong>Debug Parameters:</strong> Hidden parameters (e.g., <code>debug=true</code>) that, when enabled, expose sensitive information or alter security logic.</li>
</ul>
</li>
<li>
<p><strong>Vulnerable Behavior Example:</strong></p>
<ul>
<li>A database error message exposing parts of the SQL query and database schema (<code>Server: Msg 105, Level 15... Unclosed quotation mark...</code>).</li>
<li>A stack trace showing internal class names, file paths, and library versions.</li>
<li>A comment in source code: <code>char buf; // I hope this is big enough</code> indicating a potential buffer overflow.</li>
<li>An application logging plaintext passwords.</li>
</ul>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is generally a <strong>lack of security awareness during development and deployment</strong>, leading to implicit trust in internal processes or components. Developers may leave debugging features enabled in production, fail to strip sensitive comments, or not configure logging appropriately.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Generic Error Messages:</strong> <strong>Never return verbose error messages, stack traces, or debug information to the user's browser</strong>. Implement a single, generic error page.</li>
<li><strong>Secure Logging:</strong> Log sensitive information only to a <strong>secure, server-side log file</strong> that is not publicly accessible. Sanitize all event data to prevent log injection attacks and to remove sensitive data.</li>
<li><strong>Remove Debug Functionality:</strong> Ensure all debugging functionality, test code, and development-specific content are <strong>removed or disabled</strong> in production environments.</li>
<li><strong>Code Review for Sensitive Comments:</strong> Conduct thorough code reviews to <strong>identify and remove sensitive comments</strong> (e.g., TODOs for security, hardcoded credentials) from production code.</li>
<li><strong>Disable Directory Listings:</strong> Configure web servers to <strong>disable directory listings</strong>.</li>
<li><strong>Apply Least Privilege:</strong> Ensure that accounts and processes run with minimal privileges, limiting the information accessible even if compromised.</li>
</ol>
</li>
<li>
<p><strong>Explanation of Fix:</strong> <strong>Generic error messages</strong> deny attackers clues about the application's internal structure or specific vulnerabilities. <strong>Secure logging</strong> ensures sensitive data remains confidential even if an attack triggers verbose logging. <strong>Removing debug features and sensitive comments</strong> prevents attackers from leveraging internal developer notes or functionality for exploitation. <strong>Disabling directory listings</strong> prevents attackers from easily mapping application content.</p>
</li>
</ul>
<hr />
<h3 id="13-cross-domain-data-capture-and-related-client-side-injections"><strong>13. Cross-Domain Data Capture (and related Client-Side Injections)</strong></h3>
<p>This category covers attacks that leverage application or browser weaknesses to <strong>exfiltrate sensitive data across domain boundaries</strong> or inject client-side code in unexpected ways, often bypassing the Same-Origin Policy.</p>
<h4 id="ui-redress-attacks-clickjackingstrokejacking"><strong>UI Redress Attacks (Clickjacking/Strokejacking)</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> UI Redress attacks, like clickjacking, trick users into <strong>clicking on invisible or disguised elements</strong> on a malicious webpage that are actually transparent overlays of elements from another, legitimate site. This can lead to unintended actions on the legitimate site, such as making purchases, changing settings, or revealing sensitive information. Strokejacking is similar but involves keylogging.</p>
</li>
<li>
<p><strong>Vulnerable Behavior Example:</strong> (Representative, based on)
    A legitimate website allows a one-click purchase button. An attacker loads this site in an invisible iframe on their malicious site and overlays a tempting "Click here for a free prize!" button over the purchase button. When the user clicks for the "prize," they unknowingly trigger the purchase on the legitimate site.</p>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is the <strong>absence of proper frame-busting defenses</strong> (HTTP headers) by the legitimate application, allowing it to be embedded within iframes on other domains.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>X-Frame-Options Header:</strong> Implement the <strong><code>X-Frame-Options</code> HTTP header</strong> with <code>DENY</code> or <code>SAMEORIGIN</code> values to prevent the page from being embedded in iframes on other domains.</li>
<li><strong>Content Security Policy (CSP) <code>frame-ancestors</code> directive:</strong> Use CSP's <code>frame-ancestors</code> directive for more granular control over framing.</li>
<li><strong>Frame-Busting JavaScript:</strong> While less reliable than headers, JavaScript frame-busting code can be used as a secondary defense.</li>
</ol>
</li>
<li>
<p><strong>Explanation of Fix:</strong> The <strong><code>X-Frame-Options</code> header</strong> instructs the browser not to display the page in a frame if it's from a different origin, directly preventing clickjacking attacks by removing the attacker's ability to overlay content.</p>
</li>
</ul>
<h4 id="client-side-cookie-injection"><strong>Client-Side Cookie Injection</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> Client-side cookie injection allows an attacker to <strong>inject arbitrary cookies into a user's browser for a specific domain</strong>. This can bypass certain client-side controls or lead to session fixation if the application accepts the injected cookie as a valid session identifier.</p>
</li>
<li>
<p><strong>Vulnerable Behavior Example:</strong> (Representative, based on)
    An application echoes unvalidated user input into a JavaScript string that is then used to set a cookie.
    <div class="language-javascript highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="c1">// JavaScript (representative)</span>
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;user=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">decodeURIComponent</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">hash</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mf">1</span><span class="p">));</span><span class="w"> </span><span class="c1">// Vulnerable</span>
</span></code></pre></div>
    An attacker crafts a URL like <code>http://example.com/page#user=attacker%3B%20sessionid=fixedvalue</code>, which could inject <code>sessionid</code> into the victim's cookies.</p>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is the <strong>unvalidated inclusion of user-controlled data into client-side scripts that set cookies</strong>, or server-side reflected input that can influence client-side cookie setting.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Strict Client-Side Input Validation:</strong> Validate and sanitize all user input used in client-side scripts before it is used to set cookies.</li>
<li><strong>Output Encoding:</strong> Properly encode user input on the server-side before reflecting it into JavaScript or HTML where it might influence cookie setting.</li>
<li><strong>Server-Side Session Fixation Prevention:</strong> Implement server-side session fixation prevention by issuing a new session ID after login.</li>
</ol>
</li>
<li>
<p><strong>Explanation of Fix:</strong> <strong>Strict validation and encoding</strong> prevent malicious characters from being interpreted as cookie-setting commands in client-side scripts. <strong>Server-side session fixation prevention</strong> ensures that even if a cookie is injected, it won't be used for an authenticated session.</p>
</li>
</ul>
<hr />
<h3 id="14-shared-hosting-and-architecture-vulnerabilities"><strong>14. Shared Hosting and Architecture Vulnerabilities</strong></h3>
<p>These vulnerabilities arise from weaknesses in the <strong>application's overall architecture, especially in multi-tiered or shared hosting environments</strong>. Improper segregation or trust relationships can allow a compromise in one component or application to affect others.</p>
<h4 id="inadequate-segregation-in-tiered-architectures"><strong>Inadequate Segregation in Tiered Architectures</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> In multi-tiered architectures (e.g., web server, application server, database server), inadequate segregation means that a compromise in one tier can lead to <strong>compromise of other tiers due to overly permissive trust relationships</strong>. For example, if the web application runs with high database privileges, a SQL injection on the web tier can fully compromise the database.</p>
</li>
<li>
<p><strong>Vulnerable Behavior Example:</strong></p>
<ul>
<li>Web application connecting to the database using the <strong>DBA (Database Administrator) account</strong>, instead of a least-privileged account.</li>
<li>Application server process having file read/write access to MySQL data files.</li>
<li>Decryption keys for sensitive data stored on the same tier as the encrypted data.</li>
</ul>
</li>
<li>
<p><strong>Root Cause:</strong> The root cause is the <strong>failure to apply the principle of least privilege across different tiers and components</strong>. Implicit trust is often placed between tiers, assuming that a higher-tier component will always properly enforce security controls for lower tiers.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Principle of Least Privilege:</strong> Apply the <strong>principle of least privilege rigorously across all tiers and components</strong>. Each tier should only have the minimum necessary permissions to perform its function.</li>
<li><strong>Separate Accounts/Permissions:</strong> Use <strong>separate, restricted accounts for database access</strong>, file system operations, and inter-component communication, each with only the necessary permissions.</li>
<li><strong>Secure Key Management:</strong> Store decryption keys in a separate, highly secured key management system or different tier, separate from the encrypted data.</li>
<li><strong>Network Segmentation:</strong> Implement <strong>strict network segmentation</strong> between tiers to limit direct communication paths and enforce security policies.</li>
</ol>
</li>
<li>
<p><strong>Explanation of Fix:</strong> <strong>Applying least privilege</strong> minimizes the "blast radius" of a compromise. If the web tier is compromised, an attacker cannot automatically gain DBA privileges if the web application only connects with a limited-privilege account. <strong>Segregating keys and sensitive data</strong> prevents direct access to them even if the application component itself is breached.</p>
</li>
</ul>
<hr />
<h3 id="15-vulnerable-server-configuration-and-software"><strong>15. Vulnerable Server Configuration and Software</strong></h3>
<p>These refer to weaknesses in the web server and application server software itself, or its configuration, which can be leveraged by attackers to compromise the application or underlying system.</p>
<h4 id="default-credentials-content"><strong>Default Credentials &amp; Content</strong></h4>
<ul>
<li>
<p><strong>Description / Definition:</strong> Vulnerabilities due to web servers or application servers running with <strong>default administrative credentials</strong> or exposing <strong>default, unnecessary content</strong> (e.g., sample pages, administration interfaces) in a production environment.</p>
</li>
<li>
<p><strong>Vulnerable Behavior Example:</strong></p>
<ul>
<li>Leaving <code>admin/admin</code> as the default login for a server management console.</li>
<li>Apache Tomcat's default "manager" application being accessible in production without strong authentication.</li>
<li>Default documentation or example scripts being browsable, potentially revealing server versions or internal paths.</li>
</ul>
</li>
<li>
<p><strong>Root Cause:</strong> A lack of <strong>hardening and security awareness during deployment</strong>. Vendors ship products with defaults for ease of use, but these are often insecure for production, and administrators fail to change them.</p>
</li>
<li>
<p><strong>Remediation / Secure Fix:</strong></p>
<ol>
<li><strong>Change Default Credentials:</strong> <strong>Immediately change all default usernames and passwords</strong> for web servers, application servers, and any management interfaces.</li>
<li><strong>Remove Default/Unnecessary Content:</strong> <strong>Remove or disable all default, sample, or unnecessary content and applications</strong> from production servers.</li>
<li><strong>Restrict Management Interfaces:</strong> Limit access to administrative interfaces to <strong>trusted IP addresses only</strong> and/or unique, strong credentials, possibly on a different port.</li>
</ol>
</li>
<li>
<p><strong>Explanation of Fix:</strong> Changing <strong>default credentials</strong> removes easy entry points for attackers who rely on publicly known default logins. <strong>Removing unnecessary content</strong> reduces the attack surface by eliminating potentially vulnerable or informative files/applications that are not needed for production.</p>
</li>
</ul>
<hr />
<h3 id="key-takeaways-best-practices-and-patterns"><strong>Key Takeaways, Best Practices, and Patterns</strong></h3>
<p>This comprehensive analysis reveals several recurring themes and best practices for developing secure applications:</p>
<ol>
<li><strong>Never Trust User Input:</strong> This is the <strong>fundamental principle</strong> of web application security. All input from users, external components, or untrusted sources must be <strong>validated and sanitized</strong>.</li>
<li><strong>Validate on Output (Context-Sensitive Encoding):</strong> For vulnerabilities like XSS, <strong>output encoding</strong> based on the context of where data is inserted into HTML, JavaScript, or URLs is paramount. Input validation helps, but output encoding is the critical control for display.</li>
<li><strong>Separate Code from Data:</strong> For injection vulnerabilities (SQL, LDAP, XPath, OS Command, Script), the core issue is the <strong>blending of code and data</strong>. Use <strong>parameterized queries</strong> or APIs that strictly separate user input from executable commands/queries.</li>
<li><strong>Implement Robust Authorization Server-Side:</strong> <strong>All access control decisions must be enforced on the server-side</strong>. Client-side controls are easily bypassed. Employ <strong>least privilege</strong> and perform <strong>per-resource/per-function authorization checks</strong>.</li>
<li><strong>Strong Cryptography:</strong> Use <strong>standard, well-vetted, and cryptographically strong algorithms</strong> for hashing passwords (with salts and adaptive functions) and encrypting sensitive data. <strong>Never "roll your own crypto"</strong>.</li>
<li><strong>Secure Session Management:</strong> Generate <strong>cryptographically strong and unpredictable session IDs</strong>. <strong>Regenerate session IDs</strong> upon authentication or privilege change. Transmit session tokens <strong>only over HTTPS</strong> and use <code>Secure</code> and <code>HttpOnly</code> flags.</li>
<li><strong>Generic Error Handling:</strong> <strong>Avoid verbose error messages, stack traces, or debug information</strong> in production. Provide generic error messages to prevent information leakage.</li>
<li><strong>Secure Defaults and Hardening:</strong> Always <strong>change default credentials</strong> and <strong>remove unnecessary services, content, and debug functionality</strong> in production environments. Configure components with the <strong>principle of least privilege</strong>.</li>
<li><strong>Defense in Depth:</strong> No single control is foolproof. Implement <strong>multiple layers of security controls</strong> throughout the application's design and development lifecycle to provide redundancy in case one defense fails.</li>
<li><strong>Regular Security Testing &amp; Code Review:</strong> Conduct <strong>manual secure code reviews</strong> and penetration testing in addition to automated tools. Manual review provides contextual understanding and can find subtle logic flaws that tools miss. Automated tools can aid in finding common vulnerabilities and scanning large codebases.</li>
<li><strong>Developer Education:</strong> Many vulnerabilities stem from a lack of security awareness. <strong>Continuous training for developers</strong> on secure coding practices is crucial.</li>
</ol>
<p>By adhering to these principles, developers can significantly reduce the attack surface and enhance the overall security posture of web applications.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>